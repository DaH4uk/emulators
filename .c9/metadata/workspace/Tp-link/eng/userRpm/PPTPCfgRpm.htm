{"filter":false,"title":"PPTPCfgRpm.htm","tooltip":"/Tp-link/eng/userRpm/PPTPCfgRpm.htm","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":590,"column":0},"action":"insert","lines":["<SCRIPT language=\"javascript\" type=\"text/javascript\">","var pptpInf = new Array(","1,","0,","7,","0,","\"\",","\"username\",","\"password\",","0,","0,","\"0.0.0.0\",","\"0.0.0.0\",","\"0.0.0.0\",","1420,","15,","1,","0,","0,","\"0.0.0.0\",","\"0.0.0.0\",","\"0.0.0.0\",","\"0.0.0.0\",","\"0.0.0.0\",","\"0.0.0.0\",","\"0.0.0.0\",","\"0.0.0.0\",","1,","\"0.0.0.0\",","0,0 );","</SCRIPT>","<SCRIPT language=\"javascript\" type=\"text/javascript\">","var wantypeinfo = new Array(","6,","0,","\"WanCfgRpm.htm\",","1,","\"WanStaticIpCfgRpm.htm\",","2,","\"PPPoECfgRpm.htm\",","5,","\"BPACfgRpm.htm\",","6,","\"L2TPCfgRpm.htm\",","7,","\"PPTPCfgRpm.htm\",","0,0 );","</SCRIPT>","","","<LINK href=\"../dynaform/css_main.css\" rel=stylesheet>","<META http-equiv=Content-Type content=\"text/html; charset=iso-8859-1\">","<SCRIPT language=\"javascript\" src=\"../dynaform/common.js\" type=\"text/javascript\"></SCRIPT>","<SCRIPT language=\"javascript\" type=\"text/javascript\"><!--","if(window.parent == window){window.location.href=\"http://192.168.1.1\";}","function Click(){ return false;}","document.oncontextmenu=Click;","//--></SCRIPT>","<SCRIPT type=\"text/javascript\"><!--","var wanType = new Array(","\"id=\\\"t_dyma_ip\\\">Dynamic IP<\",\t//\tWAN_TYPE_DHCP = 0,","\"id=\\\"t_stat_ip\\\">Static IP<\",\t//\tWAN_TYPE_STATIC_IP, ","\"id=\\\"t_pppoe\\\">PPPoE<\",\t//\tWAN_TYPE_PPPOE, ","\"id=\\\"t_dhcp\\\">802.1x DHCP<\",\t//\tWAN_TYPE_802_1X_DHCP,","\"id=\\\"t_802_stat_ip\\\">802.1x Static IP<\",\t//\tWAN_TYPE_802_1X_STATIC_IP,","\"id=\\\"t_bpa\\\">BigPond Cable<\",\t//\tWAN_TYPE_BPA,","\"id=\\\"t_l2tp\\\">L2TP<\",\t//\tWAN_TYPE_L2TP,","\"id=\\\"t_pptp\\\">PPTP<\",\t//\tWAN_TYPE_PPTP,","\"\"\t//\tWAN_TYPE_END",");","var PPPoELinkStat = new Array(","\"<span id=\\\"t_disconnect\\\">Disconnected!</span>\",","\"<span id=\\\"t_connect\\\">Connected</span>\",","\"<span id=\\\"t_connecting\\\">Connecting...</span>\"",");","","function doSubmit()","{","\tvar element = document.forms[0].PPTPName;","\tif (element && element.value == \"\")","\t{","\t\talert(js_usrname_req = \"User Name is required.\");","\t\telement.focus();","\t\telement.select();","\t\treturn false;","\t}","\t","\telement = document.forms[0].PPTPPwd;","\tif (element && element.value == \"\")","\t{","\t\talert(js_passwd_req = \"Password is required.\");","\t\telement.focus();","\t\telement.select();","\t\treturn false;","\t}","\t","\tvar val;","\tval=document.forms[0].mtu.value;","\telement =document.forms[0].mtu;","    if(is_digit(val) == false)","    {","        if(element)","        {","            element.focus();","            element.select();","        }","        return false;","    }","    if(val<576||val>1420||val==\"\")","\t{","\t\talert(js_bad_mtu=\"Bad MTU, please input another number!\\n(576 ~ 1420, the default is 1420)\");","        if(element)","        {","            element.focus();","            element.select();","        }","        return false;","\t}","\tif(document.forms[0].IpType[1].checked == true)","\t{","\t\tif(!is_ipaddr(document.forms[0].sta_ip.value))","\t\t{","\t\t\tvar element =document.forms[0].sta_ip;","\t\t\tif(element)","\t\t\t{","\t\t\t\telement.focus();","        element.select();","\t\t\t}","\t\t\treturn false;","\t\t}","\t\tif(!is_maskaddr(document.forms[0].sta_mask.value))","\t\t{","\t\t\tvar element =document.forms[0].sta_mask;","\t\t\tif(element)","\t\t\t{","\t\t\t\telement.focus();","\t\t\t\telement.select();","\t\t\t}","\t\t\treturn false;","\t\t}","\t\tif(document.forms[0].sta_gw.value != \"\")","\t\t{","\t\t\tif(!is_gatewayaddr(document.forms[0].sta_gw.value))","\t\t\t{","\t\t\t\tvar element =document.forms[0].sta_gw;","\t\t\t\tif(element)","\t\t\t\t{","\t\t\t\t\telement.focus();","          element.select();","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t}","\t\t}","\t\tif(document.forms[0].sta_dns.value != \"\")","\t\t{","\t\t\tif(!ipverify(document.forms[0].sta_dns.value))","\t\t\t{","\t\t\t\talert(js_dns_addr_inv=\"The DNS address is invalid, please input another one!\");","\t\t\t\tvar element =document.forms[0].sta_dns;","\t\t\t\tif(element)","\t\t\t\t{","\t\t\t\t\telement.focus();","\t\t\t\t\telement.select();","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t}","\t\t}","\t}    ","    //added by ZQQ £¬07.12.24 To check the IP is valid when the server is an IP address","     var ch = \".0123456789ABCDEFabcdef\";","     var c;","     var n = 0;","     var szarray = new Array();","     szarray[0,0,0,0];","     var str = document.forms[0].PPTPServerName.value;","     var obj = document.forms[0].PPTPServerName;","     if (str.length == 0)","     {","     \t alert(js_svr_ip_emp=\"Please input the server's IP address or domain name!\");","       obj.focus();","       obj.select();","       return false;","     }","     for(var i=0; i<str.length; i++)","     {","        c = str.charAt(i);","\t\tif (ch.indexOf(c) == -1)","        {","            break;//²»ÊÇIPµØÖ·","        }","        else","        {","            if(c == '.')","            {","                n++; //µãµÄ¸öÊý","            }","        }","     }","     if(n == 3)     //3¸öµã£¬¿ÉÄÜÊÇiP","     {","        for(var j = 0; j < 3; j++)","        {","            var n = str.indexOf(\".\");","            szarray[j] = str.substring(0,n);","            remain = str.substring(n+1);","            str = remain;","        }","        szarray[3] = remain;","        for(var j = 0; j < 4; j++)","        {","            if(!is_digit(szarray[j]))","            {","                obj.focus();","                obj.select();","                return false;","            }","            var val =parseInt(szarray[j]);","            if(val < 0 || val > 254)","            {","               alert(js_ip_addr_inv=\"The IP address is invalid, please input another one(1-254)!\");","               obj.focus();","               obj.select();","               return false;","            }","        }","     }","    ","\tif(document.forms[0].idletime.value !=\"\")","    {","\t\tif(!is_digit(document.forms[0].idletime.value))","        {","\t\t\tvar element =document.forms[0].idletime;","\t\t\t\tif(element)","\t\t\t\t{","\t\t\t\t\telement.focus();","                    element.select();","\t\t\t\t}","\t\t\t\treturn false;","\t\t}","\t}","\treturn true;","}","","function doChange()","{","\tvar n = 0;","\tif(pptpInf[0] > 1)","\t{","\t\tn = document.forms[0].wan.value;","\t}","\ts = \"wan=\"+n;","\tvar t = document.forms[0].wantype.selectedIndex;","\tlocation.href = \"../userRpm/\"+wantypeinfo[t*2+2]+\"?\"+s;","}","function doWanChange()","{","\tvar n = document.forms[0].wan.selectedIndex;","\tvar s = \"wan=\"+n;","\tlocation.href = \"../userRpm/WanCfgRpm.htm\"+\"?\"+s;","}","function changeIpType()","{","\tif(document.forms[0].IpType[0].checked==true) ","    {","\t\tdocument.getElementById(\"sta_ip_d\").style.display = \"none\";","\t\tdocument.getElementById(\"sta_mask_d\").style.display = \"none\";","\t\tdocument.getElementById(\"sta_gw_d\").style.display = \"none\";","\t\tdocument.getElementById(\"sta_dns_d\").style.display = \"none\";","\t\tdocument.getElementById(\"dyn_ip_d\").style.display = \"\";","\t\tdocument.getElementById(\"dyn_mask_d\").style.display = \"\";","\t\tdocument.getElementById(\"dyn_gw_d\").style.display = \"\";","\t\tdocument.getElementById(\"dyn_dns_d\").style.display = \"\";","    }","    else ","    {","\t\tdocument.getElementById(\"sta_ip_d\").style.display = \"\";","\t\tdocument.getElementById(\"sta_mask_d\").style.display = \"\";","\t\tdocument.getElementById(\"sta_gw_d\").style.display = \"\";","\t\tdocument.getElementById(\"sta_dns_d\").style.display = \"\";","\t\tdocument.getElementById(\"dyn_ip_d\").style.display = \"none\";","\t\tdocument.getElementById(\"dyn_mask_d\").style.display = \"none\";","\t\tdocument.getElementById(\"dyn_gw_d\").style.display = \"none\";","\t\tdocument.getElementById(\"dyn_dns_d\").style.display = \"none\";","    }","    }","var stopRefresh=0;","function doOnblur()","{","    stopRefresh = 0;","}","function doClick()","{","\tstopRefresh=1;","}","function doRefresh()","{    ","\tif (0==stopRefresh)","\t{","    var IPtype;","\t  if(document.forms[0].IpType[0].checked==true) ","    {","        IPtype=0;","    }","    else ","    {","        IPtype=1;","    }","\t\tlocation.href=\"PPTPCfgRpm.htm?&IpType=\"+IPtype;","\t}","\twindow.setTimeout(\"doRefresh()\",10000);","}","function doDetect()","{","\tlocation.href=\"PPTPCfgRpm.htm?detect=1\";","}","","function refresh()","{\t","\tlocation.href=\"PPTPCfgRpm.htm?dorefresh=1\";\t","}","//--></SCRIPT>","</HEAD>","<BODY onLoad=\"changeIpType();setTagStr(document,'ntw_pptp_cfg');LoadHelp('PptpCfgHelpRpm.htm'); resize(this);\" onResize=\"resize(this);\">","<CENTER>","  <FORM action=\"PPTPCfgRpm.htm\" enctype=\"multipart/form-data\" method=\"get\" onSubmit=\"return doSubmit();\">","    <TABLE id=\"autoWidth\">","      <TR>","        <TD class=h1 colspan=2 id = \"t_title\">WAN</TD>","      </TR>","      <TR>","        <TD class=blue colspan=2></TD>","      </TR>","      <SCRIPT type=\"text/javascript\">","","if(pptpInf[0] > 1)","{","\tdocument.write('<TR><TD class=Item id = \\\"t_wan_port\\\">WAN Port:</TD><TD><select name=\\\"wan\\\" id=\\\"wan\\\" onChange=\\\"doWanChange()\\\" onFocus = \\\"doClick()\\\" onblur = \\\"doOnblur()\\\">');","\tfor(var i=0;i<pptpInf[0];i++)","\t{","\t\tdocument.write('<option value=\\\"'+i+'\\\">WAN'+ (i+1) +'</option>');","\t}","\tdocument.write('</select>');","}","//added by ZQQ,08.12.10 , if one wan, it should be exist but not display","else","{\t","\tdocument.write('<TR style =\"display:none\"><TD class=Item id = \\\"t_wan_port\\\">WAN Port:</TD><TD><select name=\\\"wan\\\" id=\\\"wan\\\" onChange=\\\"doWanChange()\\\">')","\tdocument.write('<option value=0>WAN1</option>');","    document.write('</select>');","}","</SCRIPT>","      <TR>","        <TD class=Item id=\"t_wan_conn_tp\">WAN Connection Type:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<SELECT name=\"wantype\" onblur = \"doOnblur()\" onfocus=\"doClick();\" onChange=\"doChange()\">","            <SCRIPT type=\"text/javascript\">","for ( var t=0; t < wantypeinfo[0]; t++)","{","\tdocument.write('<option value=\"'+wantypeinfo[t*2+1]+'\" '+wanType[wantypeinfo[t*2+1]]+'/option>');","}","</SCRIPT>","\t\t\t\t\t</SELECT>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD colspan=2></TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_username\">User Name:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"PPTPName\" type=\"text\" class=\"text\" value=\"\" size=\"25\" maxlength=\"31\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_password\">Password:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"PPTPPwd\" type=\"password\" class=\"text\" value=\"\" size=\"25\" maxlength=\"63\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD></TD>","\t\t\t\t<TD class=emp>","\t\t\t\t\t<INPUT name=\"Connect\" type=\"submit\" class=\"button\" value=\"Connect\">","          &nbsp;&nbsp;","          <INPUT name=\"Disconnect\" type=\"submit\" class=\"button\" value=\"Disconnect\">","          <SCRIPT type=\"text/javascript\">","switch(pptpInf[8]) //0 -Disconected ; 1 -connected ; 2 -Connecting...","{\t\t","\tcase 0:","\tdocument.write('&nbsp;&nbsp;<span id = \"t_disconnected\">Disconnected!</span>');","\tbreak;","\t","\tcase 1:","\tdocument.write('&nbsp;&nbsp;<span id = \"t_connected\">Connected!</span>');","\tbreak;","\t","\tcase 2:","\tdocument.write('&nbsp;&nbsp;<span id = \"t_connecting\">Connecting...</span>');","\tbreak;","\t","\tdefault:","\tdocument.write('&nbsp;&nbsp;--');","\tbreak;","}","</SCRIPT>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD colspan=2></TD>","      </TR>","      <TR>","        <TD></TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT type=\"radio\" name=\"IpType\" value=\"0\" onClick=\"changeIpType();\">","\t\t\t\t\t<SPAN id = \"t_dynamic_ip\">Dynamic IP</SPAN>","\t\t\t\t\t&nbsp;&nbsp;","\t\t\t\t\t<INPUT type=\"radio\" name=\"IpType\" value=\"1\" onClick=\"changeIpType();\">","\t\t\t\t\t<SPAN id = \"t_static_ip\">Static IP</SPAN>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_svr_ip_addr\">Server IP Address/Name:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"PPTPServerName\" type=\"text\" class=\"text\" value=\"\" size=\"32\" maxlength=\"63\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_ip_addr\">IP Address:</TD>","\t\t<TD id=\"sta_ip_d\">","\t\t\t<INPUT name=\"sta_ip\" type=\"text\" class=\"text\" value=\"\" size=\"15\" maxlength=\"15\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t</TD>","\t\t<TD id=\"dyn_ip_d\">","\t\t\t<DIV id=dyn_ip>-</DIV>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_sub_mask\">Subnet Mask:</TD>","\t\t\t\t<TD id=\"sta_mask_d\">","\t\t\t\t\t<INPUT name=\"sta_mask\" type=\"text\" class=\"text\" value=\"\" size=\"15\" maxlength=\"15\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t</TD>","\t\t\t\t<TD id=\"dyn_mask_d\">","\t\t\t\t\t<DIV id=dyn_mask>-</DIV>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_gateway\">Gateway:</TD>","\t\t\t\t<TD id=\"sta_gw_d\">","\t\t\t\t\t<INPUT name=\"sta_gw\" type=\"text\" class=\"text\" value=\"\" size=\"15\" maxlength=\"15\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t</TD>","\t\t\t\t<TD id=\"dyn_gw_d\">","\t\t\t\t\t<DIV id=dyn_gw>-</DIV>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_dns\">DNS:</TD>","\t\t\t\t<TD id=\"sta_dns_d\">","\t\t\t\t\t<INPUT name=\"sta_dns\" type=\"text\" class=\"text\" value=\"\" size=\"15\" maxlength=\"15\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t</TD>","\t\t\t\t<TD id=\"dyn_dns_d\">","\t\t\t\t\t<DIV id=dyn_dns>-</DIV>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD colspan=2></TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_inter_ip_addr\">Internet IP Address:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<SCRIPT type=\"text/javascript\">","document.write('<div id=InetAddr>-</div>');","</SCRIPT>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_inter_dns\">Internet DNS:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<SCRIPT type=\"text/javascript\">","document.write('<div id=InetDns>-</div>');","</SCRIPT>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD colspan=2></TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_mtu_sizes\">MTU Size (in bytes):</TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"mtu\" type=\"text\" class=\"text\" value=\"\" size=\"5\" maxlength=\"5\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t\t<SPAN id=\"t_desc1\">&nbsp;(The default is 1420, do not change unless necessary.)</SPAN>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=\"Item\" id=\"t_maxidletime\">Max Idle Time:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"idletime\" class=\"text\" value=\"5\" size=\"5\" maxlength=\"2\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t\t<SPAN id=\"t_desc2\">&nbsp;minutes (0 means remain active at all times.)</SPAN>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD colspan=2></TD>","      </TR>","      <TR>","        <TD class=Item id=\"t_wan_conn_mode\">WAN Connection Mode:</TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"linktype\" type=\"radio\" value=\"1\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t\t<SPAN id=\"t_conn_demand\">Connect on Demand</SPAN>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item></TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT type=\"radio\" name=\"linktype\" value=\"2\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t\t<SPAN  id=\"t_conn_auto\">Connect Automatically</SPAN>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=Item></TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"linktype\" type=\"radio\" value=\"3\" onFocus=\"doClick();\" onBlur=\"doOnblur()\">","\t\t\t\t\t<SPAN  id=\"t_conn_manu\">Connect Manually</SPAN>","\t\t\t\t</TD>","      </TR>","      <TR>","        <TD class=blue colspan=2></TD>","      </TR>","      <TR>","        <TD></TD>","\t\t\t\t<TD>","\t\t\t\t\t<INPUT name=\"Save\" type=\"submit\" class=\"buttonBig\" value=\"Save\">","\t\t\t\t</TD>","      </TR>","    </TABLE>","  </FORM>","</CENTER>","</BODY>","<HEAD>","<META http-equiv=\"pragma\" content=\"no-cache\">","</HEAD>","</HTML>","<SCRIPT type=\"text/javascript\">","if(pptpInf[25])","{","\twindow.setTimeout(\"doRefresh()\",10000);","}","if(pptpInf[0] > 1)","{","    document.forms[0].wan.selectedIndex = pptpInf[1];","}","document.forms[0].wantype.value = pptpInf[2];","if (pptpInf[3]==0)","{","\tdocument.forms[0].IpType[0].checked =true;","}","else","{","\tdocument.forms[0].IpType[1].checked =true;","","}","","document.getElementById(\"dyn_ip\").innerHTML = pptpInf[9];","document.getElementById(\"dyn_mask\").innerHTML = pptpInf[10];","document.getElementById(\"dyn_gw\").innerHTML = pptpInf[11];","document.getElementById(\"dyn_dns\").innerHTML = pptpInf[23]+' , ' + pptpInf[24];","document.forms[0].sta_ip.value = pptpInf[18];","document.forms[0].sta_mask.value = pptpInf[19];","document.forms[0].sta_gw.value = pptpInf[20];","document.forms[0].sta_dns.value = pptpInf[26];","","document.forms[0].PPTPServerName.value = pptpInf[4];","document.forms[0].PPTPName.value = pptpInf[5];","document.forms[0].PPTPPwd.value = pptpInf[6];","document.forms[0].Connect.disabled = (pptpInf[7]||pptpInf[8]==2)?true:false;","document.forms[0].Disconnect.disabled = (pptpInf[7]||pptpInf[8]==2)?false:true;","document.forms[0].mtu.value = pptpInf[12];","document.forms[0].idletime.value = pptpInf[13];","if (pptpInf[14]==1)","{","\tdocument.forms[0].linktype[0].checked =true;","}","else if (pptpInf[14]==2)","{","\tdocument.forms[0].linktype[1].checked =true;","}","else","{","\tdocument.forms[0].linktype[2].checked =true;","}","document.getElementById(\"InetAddr\").innerHTML = pptpInf[17];","document.getElementById(\"InetDns\").innerHTML = pptpInf[21]+' , ' + pptpInf[22];","</SCRIPT>",""],"id":1}]]},"ace":{"folds":[],"scrolltop":5901,"scrollleft":0,"selection":{"start":{"row":590,"column":0},"end":{"row":590,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":420,"state":"js-start","mode":"ace/mode/html"}},"timestamp":1468782919940,"hash":"1fb424919817473982dd6bd3044502ecf14afa55"}