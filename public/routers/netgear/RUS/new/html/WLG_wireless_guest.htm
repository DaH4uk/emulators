
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- include page -->
<link type="text/css" rel="stylesheet" href="skin/basic_home.css" media="screen" />
<link type="text/css" rel="stylesheet" href="skin/common.css" media="screen" />
<link type="text/css" rel="stylesheet" href="skin/form.css">
<script type="text/javascript" src="js/boot.js"></script>
<script type="text/javascript" src="js/secboot.js"></script>
<script type="text/javascript" src="js/ip4hops.js"></script>
<script type="text/javascript" src="js/comBasicFun.js"></script>
<script type="text/javascript" src="languages/Russian/error.js"></script>
<script type="text/javascript" src="languages/Russian/alert_error.js"></script>
<script type="text/javascript" src="languages/Russian/menu.js"></script>
<script type="text/javascript" src="languages/Russian/page/WLG_wireless_guest.js"></script>
<script type="text/javascript">
<!--
var menu_Type = "basic";
/*---- Global variable define -----*/
var G_Error = "0";
var G_Status= "0";
var G_Error_Msg= "";
var G_ViewState= "-";
var userLevel = "1";
var G_Menu = "basic";
var G_Page = "WLG_wireless_guest";
var G_SubPage = "-";
var G_ErrorPage = "-";
// 1
var vap1=0;
var VAP1_WEPKey=[];
VAP1_WEPKey[vap1]= "";
vap1++;
VAP1_WEPKey[vap1]= "";
vap1++;
VAP1_WEPKey[vap1]= "";
vap1++;
VAP1_WEPKey[vap1]= "";
vap1++;
// 2
var vap2=0;
var VAP2_WEPKey=[];
VAP2_WEPKey[vap2]= "";
vap2++;
VAP2_WEPKey[vap2]= "";
vap2++;
VAP2_WEPKey[vap2]= "";
vap2++;
VAP2_WEPKey[vap2]= "";
vap2++;
// 3
var vap3=0;
var VAP3_WEPKey=[];
VAP3_WEPKey[vap3]= "";
vap3++;
VAP3_WEPKey[vap3]= "";
vap3++;
VAP3_WEPKey[vap3]= "";
vap3++;
VAP3_WEPKey[vap3]= "";
vap3++;
// 4
var vap4=0;
var VAP4_WEPKey=[];
VAP4_WEPKey[vap4]= "";
vap4++;
VAP4_WEPKey[vap4]= "";
vap4++;
VAP4_WEPKey[vap4]= "";
vap4++;
VAP4_WEPKey[vap4]= "";
vap4++;
var m=0;
var W_Enable=[];
var W_SSID=[];
var W_BeaconType=[];
var W_BasicEncryptionModes=[];
var W_BasicAuthenticationMode=[];
var W_SSIDAdvertisementEnabled=[];
var W_allow_access=[];
var W_APIsolate=[];
W_Enable[m]="1";//Enable
W_SSID[m]="NETGEAR95";
W_BeaconType[m]="11i";
W_BasicEncryptionModes[m]="WEPEncryption";
W_BasicAuthenticationMode[m]="None";
W_SSIDAdvertisementEnabled[m]="1";
W_APIsolate[m]="0";
W_allow_access[m]="1";
m++;
W_Enable[m]="0";//Enable
W_SSID[m]="NETGEAR-Guest";
W_BeaconType[m]="None";
W_BasicEncryptionModes[m]="";
W_BasicAuthenticationMode[m]="None";
W_SSIDAdvertisementEnabled[m]="1";
W_APIsolate[m]="0";
W_allow_access[m]="0";
m++;
W_Enable[m]="0";//Enable
W_SSID[m]="NetGear-003";
W_BeaconType[m]="None";
W_BasicEncryptionModes[m]="";
W_BasicAuthenticationMode[m]="None";
W_SSIDAdvertisementEnabled[m]="1";
W_APIsolate[m]="0";
W_allow_access[m]="0";
m++;
W_Enable[m]="0";//Enable
W_SSID[m]="NetGear-004";
W_BeaconType[m]="None";
W_BasicEncryptionModes[m]="";
W_BasicAuthenticationMode[m]="None";
W_SSIDAdvertisementEnabled[m]="1";
W_APIsolate[m]="0";
W_allow_access[m]="0";
m++;
W_Enable[m]="0";//Enable
W_SSID[m]="NetGear-005";
W_BeaconType[m]="None";
W_BasicEncryptionModes[m]="";
W_BasicAuthenticationMode[m]="None";
W_SSIDAdvertisementEnabled[m]="1";
W_APIsolate[m]="0";
W_allow_access[m]="0";
m++;
var n=0;
var W_WEPKeyIndex=[];
var W_WEPEncryptionLevel=[];
var W_WPAEncryptionModes=[];
var W_WPAAuthenticationMode=[];
W_WEPKeyIndex[n]="1";
W_WEPEncryptionLevel[n]="40-bit";
W_WPAEncryptionModes[n]="AESEncryption";
W_WPAAuthenticationMode[n]="PSKAuthentication";
n++;
W_WEPKeyIndex[n]="1";
W_WEPEncryptionLevel[n]="40-bit";
W_WPAEncryptionModes[n]="";
W_WPAAuthenticationMode[n]="PSKAuthentication";
n++;
W_WEPKeyIndex[n]="1";
W_WEPEncryptionLevel[n]="40-bit";
W_WPAEncryptionModes[n]="";
W_WPAAuthenticationMode[n]="PSKAuthentication";
n++;
W_WEPKeyIndex[n]="1";
W_WEPEncryptionLevel[n]="40-bit";
W_WPAEncryptionModes[n]="";
W_WPAAuthenticationMode[n]="PSKAuthentication";
n++;
W_WEPKeyIndex[n]="1";
W_WEPEncryptionLevel[n]="40-bit";
W_WPAEncryptionModes[n]="";
W_WPAAuthenticationMode[n]="PSKAuthentication";
n++;
var WG_KeyPassphrase;
var WG_PreSharedKey;
WG_KeyPassphrase="";
WG_PreSharedKey="";
var WDS_Enable="0";
var WDS_WDSMode="";
var G_DeviceInfoRegion="RU";
var G_passphrase_state=0;
function TableOnload()
{
var i;
var SecurityType=[0];
var SecurityI;
Form.Radio('guestID','1');
SelectProfile(1);
for(i=1;i<=4;i++)
{
if(W_BeaconType[i]=="None")
SecurityType[i]="None";
else if(W_BeaconType[i]=="Basic")
SecurityType[i]="WEP";
else if(W_BeaconType[i]=="WPA")
SecurityType[i]="TKIP";
else if(W_BeaconType[i]=="11i")
SecurityType[i]="AES";
else if(W_BeaconType[i]=="WPAand11i")
SecurityType[i]="TKIP+AES";
}
setJSONValue({
'SSID_1':W_SSID[1],
'SSID_2':W_SSID[2],
'SSID_3':W_SSID[3],
'SSID_4':W_SSID[4],
'W_Enable_1' :W_Enable[1]>0? lang_yesno[0] : lang_yesno[1],
'W_Enable_2' :W_Enable[2]>0? lang_yesno[0] : lang_yesno[1],
'W_Enable_3' :W_Enable[3]>0? lang_yesno[0] : lang_yesno[1],
'W_Enable_4' :W_Enable[4]>0? lang_yesno[0] : lang_yesno[1],
'Advertisement_1' :W_SSIDAdvertisementEnabled[1]>0? lang_yesno[0] : lang_yesno[1],
'Advertisement_2' :W_SSIDAdvertisementEnabled[2]>0? lang_yesno[0] : lang_yesno[1],
'Advertisement_3' :W_SSIDAdvertisementEnabled[3]>0? lang_yesno[0] : lang_yesno[1],
'Advertisement_4' :W_SSIDAdvertisementEnabled[4]>0? lang_yesno[0] : lang_yesno[1],
'Security_1': (SecurityType[1] == 'None') ? lang_yesno[2] : SecurityType[1],
'Security_2': (SecurityType[2] == 'None') ? lang_yesno[2] : SecurityType[2],
'Security_3': (SecurityType[3] == 'None') ? lang_yesno[2] : SecurityType[3],
'Security_4': (SecurityType[4] == 'None') ? lang_yesno[2] : SecurityType[4]
});
}
var Array_For_repeater = ['RADIO_Tkip','RADIO_Aes','RADIO_TkipAes'];
function DisWpaForRepeater(_A,_Bool)
{
if(G_DeviceInfoRegion=='PR')
{
return;
}
else
{
for(var _num=0; _num < _A.length; _num++)
{
$(_A[_num]).disabled=_Bool;
}
}
}
function SelectProfile(num)
{
supplyValue('Profile_wirelessnum',num);
supplyValue('Profile_securitynum',num);
supplyValue('ssid',W_SSID[num]);
supplyValue('enable_bssid',W_Enable[num]);
supplyValue('enable_ssid_bc',W_SSIDAdvertisementEnabled[num]);
supplyValue('allow_access',W_allow_access[num]);
supplyValue('wlan_iso',W_APIsolate[num]);
Onload_SecurityOptions(num);
}
function displayid(flag,id)
{
if(flag==0)
$(id).style.display='none';
else if(flag==1)
$(id).style.display='';
}
function uiKeyInputMaxlength()
{
if($('wepenc').value == '1')
return 10;
if($('wepenc').value == '2')
return 26;
}
function setKeys()
{
var cf=document.getElementsByName('wepenc');
if (cf.wepenc.selectedIndex == 0)
{
var keysize = 10;
$('KEY1').size = $('KEY2').size = $('KEY3').size = $('KEY4').size = keysize + 5 ; // extra for Mac
if ($('KEY1').value.length>10)
$('KEY1').value = $('KEY1').value.substring(0,10);
if ($('KEY2').value.length>10)
$('KEY2').value = $('KEY2').value.substring(0,10);
if ($('KEY3').value.length>10)
$('KEY3').value = $('KEY3').value.substring(0,10);
if ($('KEY4').value.length>10)
$('KEY4').value = $('KEY4').value.substring(0,10);
$('KEY1').maxLength=10;
$('KEY2').maxLength=10;
$('KEY3').maxLength=10;
$('KEY4').maxLength=10;
}
else if(cf.wepenc.selectedIndex == 1)
{
var keysize = 26;
$('KEY1').size = $('KEY2').size = $('KEY3').size = $('KEY4').size = keysize + 15 ; // extra for Mac
if ($('KEY1').value.length>26)
$('KEY1').value = $('KEY1').value.substring(0,26);
if ($('KEY2').value.length>26)
$('KEY2').value = $('KEY2').value.substring(0,26);
if ($('KEY3').value.length>26)
$('KEY3').value= $('KEY3').value.substring(0,26);
if ($('KEY4').value.length>26)
$('KEY4').value = $('KEY4').value.substring(0,26);
$('KEY1').maxLength=26;
$('KEY2').maxLength=26;
$('KEY3').maxLength=26;
$('KEY4').maxLength=26;
}
else if(cf.wepenc.selectedIndex == 2)
{
var keysize = 32;
$('KEY1').size = $('KEY2').size = $('KEY3').size = $('KEY4').size = keysize + 2 ;// extra for Mac
}
}
function getPassphraseState(num)
{
if(num=="None")
{
return "Disable";
}
else if(num=="Basic")
{
return "WEP";
}
else if(num=="WPA")
{
return "WPA-PSK";
}
else if(num=="11i")
{
return "WPA2-PSK";
}
else if(num=="WPAand11i")
{
return "AUTO-PSK";
}
}
/*刷新页面时，初始化加密方式*/
function Onload_SecurityOptions(num)
{
var L_opt_id;
if(W_BeaconType[num]=="None")
{
L_opt_id="Disable";
document.getElementsByName('security_type')[0].checked = true;
}
else if(W_BeaconType[num]=="Basic")
{
L_opt_id="WEP";
document.getElementsByName('security_type')[1].checked = true;
if(W_WEPEncryptionLevel[num]=="40-bit")
setJSONValue({'wepenc':"1"});
else if(W_WEPEncryptionLevel[num]=="104-bit")
setJSONValue({'wepenc':"2"});
if(W_BasicAuthenticationMode[num]=="AutoAuthentication")
setJSONValue({'authAlgm':"automatic"});
else if(W_BasicAuthenticationMode[num]=="SharedAuthentication")
setJSONValue({'authAlgm':"sharedkey"});
setKeys();
}
else if(W_BeaconType[num]=="WPA")
{
L_opt_id="WPA-PSK";
document.getElementsByName('security_type')[2].checked = true;
}
else if(W_BeaconType[num]=="11i")
{
L_opt_id="WPA2-PSK";
document.getElementsByName('security_type')[3].checked = true;
}
else if(W_BeaconType[num]=="WPAand11i")
{
L_opt_id="AUTO-PSK";
document.getElementsByName('security_type')[4].checked = true;
}
SecurityOptions(L_opt_id,num,0);
}
function SecurityOptions(opt_id,num,_flag)
{
if(opt_id=="Disable")
{
hideChForWep('module_wep',9,'none');
hideChForWep('module_tkip',1,'none');
hideChForWep('module_aes',1,'none');
hideChForWep('module_tkipaes',1,'none');
hideChForWep('module_passphrase',1,'none');
}
else if(opt_id=="WEP")
{
hideChForWep('module_wep',9,'');
hideChForWep('module_tkip',1,'none');
hideChForWep('module_aes',1,'none');
hideChForWep('module_tkipaes',1,'none');
hideChForWep('module_passphrase',1,'none');
Form.Radio('wep_key_no',W_WEPKeyIndex[num]);
if(_flag==0)
{
if(num==1)
{
setJSONValue({
'KEY1':VAP1_WEPKey[0],
'KEY2':VAP1_WEPKey[1],
'KEY3':VAP1_WEPKey[2],
'KEY4':VAP1_WEPKey[3]
});
}
if(num==2)
{
setJSONValue({
'KEY1':VAP2_WEPKey[0],
'KEY2':VAP2_WEPKey[1],
'KEY3':VAP2_WEPKey[2],
'KEY4':VAP2_WEPKey[3]
});
}
if(num==3)
{
setJSONValue({
'KEY1':VAP3_WEPKey[0],
'KEY2':VAP3_WEPKey[1],
'KEY3':VAP3_WEPKey[2],
'KEY4':VAP3_WEPKey[3]
});
}
if(num==4)
{
setJSONValue({
'KEY1':VAP4_WEPKey[0],
'KEY2':VAP4_WEPKey[1],
'KEY3':VAP4_WEPKey[2],
'KEY4':VAP4_WEPKey[3]
});
}
}
else if(_flag==1)
{
setJSONValue({
'KEY1':'',
'KEY2':'',
'KEY3':'',
'KEY4':''
});
}
setKeys();
}
else if(opt_id=="WPA-PSK")
{
hideChForWep('module_wep',9,'none');
hideChForWep('module_tkip',1,'');
hideChForWep('module_aes',1,'none');
hideChForWep('module_tkipaes',1,'none');
hideChForWep('module_passphrase',1,'');
if(getPassphraseState(W_BeaconType[num])=='WPA-PSK' && WG_KeyPassphrase!='')
setJSONValue({'passphrase':WG_KeyPassphrase});
else if(getPassphraseState(W_BeaconType[num])=='WPA-PSK' && WG_KeyPassphrase=='')
setJSONValue({'passphrase':WG_PreSharedKey});
else
setJSONValue({'passphrase':''});
}
else if(opt_id=="WPA2-PSK")
{
hideChForWep('module_wep',9,'none');
hideChForWep('module_tkip',1,'none');
hideChForWep('module_aes',1,'');
hideChForWep('module_tkipaes',1,'none');
hideChForWep('module_passphrase',1,'');
if(getPassphraseState(W_BeaconType[num])=='WPA2-PSK' && WG_KeyPassphrase!='')
setJSONValue({'passphrase':WG_KeyPassphrase});
else if(getPassphraseState(W_BeaconType[num])=='WPA2-PSK' && WG_KeyPassphrase=='')
setJSONValue({'passphrase':WG_PreSharedKey});
else
setJSONValue({'passphrase':''});
}
else if(opt_id=="AUTO-PSK")
{
hideChForWep('module_wep',9,'none');
hideChForWep('module_tkip',1,'none');
hideChForWep('module_aes',1,'none');
hideChForWep('module_tkipaes',1,'');
hideChForWep('module_passphrase',1,'');
if(getPassphraseState(W_BeaconType[num])=='AUTO-PSK' && WG_KeyPassphrase!='')
setJSONValue({'passphrase':WG_KeyPassphrase});
else if(getPassphraseState(W_BeaconType[num])=='AUTO-PSK' && WG_KeyPassphrase=='')
setJSONValue({'passphrase':WG_PreSharedKey});
else
setJSONValue({'passphrase':''});
var xx=getPassphraseState(W_BeaconType[num]);
}
}
function SecuritySelect(opt_id)
{
var profile_num=Number(Form.Radio('guestID'));
SecurityOptions(opt_id,profile_num,1);
}
function uiOnload()
{
//DisWpaForRepeater(Array_For_repeater,'1'==WDS_Enable&&('Repeater'==WDS_WDSMode||'BaseStation'==WDS_WDSMode));
TableOnload();
dealWithError();
}
/*
这个函数用于tkip,aes,tkip+aes几种加密方式密码设定。
当passphrase为64位时，将INPUT框里的值给节点PreSharedKey，将KeyPassphrase设为空；
当passphrase为其他位数时，反过来。
*/
function submitpassphrase()
{
var profile_num=(Number(Form.Radio('guestID'))+1)+'';
var Path = ':InternetGatewayDevice.LANDevice.1.WLANConfiguration.' + profile_num + '.' ;
if($('passphrase').value.length==64)
{
$F(Path+ 'PreSharedKey.1.PreSharedKey',$('passphrase').value);
}
else
{
$F(Path+ 'PreSharedKey.1.KeyPassphrase',$('passphrase').value);
}
}
function isHexAndSpace(str)
{
var i;
for(i = 0; i<str.length; i++) {
var c = str.substring(i, i+1);
if(("0" <= c && c <= "9") || ("a" <= c && c <= "f") || ("A" <= c && c <= "F")) {
continue;
}
return false;
}
return true;
}
function checkData()
{
var msg = ""; var blankFlag = false; var sizeOK = false; var i;
var len = ($('wepenc').selectedIndex==0)?10:(($('wepenc').selectedIndex==1)?26:32);
if ($('ssid').value == "")
{
alertError('WLG_wirelessSsidBlankWarn',1)
return false;
}
if ($('ssid').value.match( /[^\x20-\x7E]/ ))
{
alertError('WLG_wirelessSsidWrongWord',1)
$('ssid').focus();
return false;
}
$('ssid').value = Trim($('ssid').value);
if(Form.Radio('security_type')=='WEP')
{
var cf = document.getElementsByName('wep_key_no');
var node_wep=$('KEY1','KEY2','KEY3','KEY4');
for (i = 1; i < 5; i++ )
{
msg = "";
blankFlag = ! (eval("(cf[" + (i-1) + "].checked)")); // default key
if( (blankFlag) && (node_wep[i-1].value.length==0) )
continue; // blank ok
sizeOK = ((isHexAndSpace(node_wep[i-1].value)) && (node_wep[i-1].value.length==len));
if (!sizeOK)
{
msg = (len == 10)?'WLG_wirelessmsg_key64_type':((len==26)?'WLG_wirelessmsg_key128_type':'WLG_wirelessmsg_key152_type');
alertError(msg,1)
if (i==1)
$('KEY1').focus();
else if (i==2)
$('KEY2').focus();
else if (i==3)
$('KEY3').focus();
else if (i==4)
$('KEY4').focus();
return false;
}
}
}
else if(Form.Radio('security_type')=='WPA-PSK'||Form.Radio('security_type')=='WPA2-PSK'||Form.Radio('security_type')=='AUTO-PSK')
{
if ($('passphrase').value.match( /[^\x20-\x7E]/ ))
{
alertError('WLG_wirelessPassphraseWrong',1)
$('passphrase').focus();
return false;
}
if($('passphrase').value.length < 8)
{
alertError('WLG_wirelessPassphraseWrongLength8',1)
return false;
}
if($('passphrase').value.length > 63)
{
if ( isHex($('passphrase').value) == false )
{
alertError('WLG_wirelessPassphraseWrongLength63',1)
$('passphrase').value = "";
return false;
}
}
$('passphrase').value = Trim($('passphrase').value);
}
return true;
}
//maybe ok
function uiSubmit()
{
if(checkData()==false)
{
return false;
}
var nodes = $('ssid','security_type','authAlgm','wepenc','enable_bssid','enable_ssid_bc','allow_access','wlan_iso');
var node_wep=$('KEY1','KEY2','KEY3','KEY4');
var security_type_select = getNameValue('security_type');
var node_radio=$('wep_key_no1','wep_key_no2','wep_key_no3','wep_key_no4');
var profile_num=Number(Form.Radio('guestID')) + 1;
var Path = ':InternetGatewayDevice.LANDevice.1.WLANConfiguration.'+profile_num+'.';
if(security_type_select=="Disable")
{
$F(Path+'BeaconType','None');
}
else if(security_type_select=="WEP")
{
if(nodes[2].value=="automatic")
{
$F(Path+'BeaconType','Basic');
$F(Path+'BasicEncryptionModes', 'WEPEncryption');
$F(Path+'BasicAuthenticationMode', 'AutoAuthentication');
$F(Path+'WEPKeyIndex', Form.Radio('wep_key_no'));
$F(Path+'WEPKey.1.WEPKey', node_wep[0].value);
$F(Path+'WEPKey.2.WEPKey', node_wep[1].value);
$F(Path+'WEPKey.3.WEPKey', node_wep[2].value);
$F(Path+'WEPKey.4.WEPKey', node_wep[3].value);
$F(Path+'X_TWSZ-COM_WEPEncStrength', nodes[3].value=='1'?'40-bit':'104-bit');
}
else if(nodes[2].value=="sharedkey")
{
$F(Path+'BeaconType', 'Basic');
$F(Path+'BasicEncryptionModes', 'WEPEncryption');
$F(Path+'BasicAuthenticationMode', 'SharedAuthentication');
$F(Path+'WEPKeyIndex', Form.Radio('wep_key_no'));
$F(Path+'WEPKey.1.WEPKey', node_wep[0].value);
$F(Path+'WEPKey.2.WEPKey', node_wep[1].value);
$F(Path+'WEPKey.3.WEPKey', node_wep[2].value);
$F(Path+'WEPKey.4.WEPKey', node_wep[3].value);
$F(Path+'X_TWSZ-COM_WEPEncStrength', nodes[3].value=='1'?'40-bit':'104-bit');
}
}
else if(security_type_select=="WPA-PSK")
{
$F(Path+'BeaconType','WPA');
$F(Path+'WPAEncryptionModes', 'TKIPEncryption');
$F(Path+'WPAAuthenticationMode', 'PSKAuthentication');
submitpassphrase(0);
}
else if(security_type_select=="WPA2-PSK")
{
$F(Path+'BeaconType', '11i');
$F(Path+'IEEE11iEncryptionModes', 'AESEncryption');
$F(Path+'IEEE11iAuthenticationMode', 'PSKAuthentication');
submitpassphrase(1);
}
else if(security_type_select=="AUTO-PSK")
{
$F(Path+'BeaconType', 'WPAand11i');
$F(Path+'WPAEncryptionModes', 'TKIPandAESEncryption');
$F(Path+'WPAAuthenticationMode', 'PSKAuthentication');
$F(Path+'IEEE11iEncryptionModes', 'TKIPandAESEncryption');
$F(Path+'IEEE11iAuthenticationMode', 'PSKAuthentication');
submitpassphrase(2);
}
$F(Path+'SSID', nodes[0].value);
$F(Path+'Enable', nodes[4].checked==true?'1':'0');
$F(Path+'SSIDAdvertisementEnabled', nodes[5].checked==true?'1':'0');
$F(Path+'X_TWSZ-COM_GuestAccess', nodes[6].checked==true?'1':'0');
$F(Path+'X_TWSZ-COM_APIsolate', nodes[7].checked==true?'1':'0');
//
$F('obj-action','set');
$H({
'obj-action' : 'set',
'var:page' : 'WLG_wireless_guest',
'var:errorpage': 'WLG_wireless_guest',
'getpage' : '../html/basic_home.htm',
'errorpage' : '../html/basic_home.htm',
'var:CacheLastData': ViewState.Save()
});
$('uiPostForm').submit();
}
function calcPassphrase()
{
if($('passphraseStr').value.length == 0)
{
alertError('WLG_wirelesspassphraseStrBlankWarn',1);
return;
}
switch($('wepenc').value)
{
case '1':
PassPhrase40();
break;
case '2':
PassPhrase104();
break;
default:
break;
}
}
function PassPhrase40()
{
var seed = 0;
var pseed = new Array(0, 0, 0, 0);
var pkey = new Array(4);
var asciiObj = new Array(4);
Length = $('passphraseStr').value.length;
if(Length != 0)
{
for (i=0; i<Length; i++ )
pseed[i%4] ^= $('passphraseStr').value.charCodeAt(i);
seed = pseed[0];
seed += pseed[1] << 8;
seed += pseed[2] << 16;
seed += pseed[3] << 24;
}
$('KEY1').value = $('KEY2').value = "";
$('KEY3').value = $('KEY4').value = "";
pkey[0] = $('KEY1');
pkey[1] = $('KEY2');
pkey[2] = $('KEY3');
pkey[3] = $('KEY4');
for(j=0; j<4; j++)
{
for (i=0; i<5 ;i++ )
{
seed = (214013 * seed) & 0xffffffff;
if(seed & 0x80000000)
seed = (seed & 0x7fffffff) + 0x80000000 + 0x269ec3;
else
seed = (seed & 0x7fffffff) + 0x269ec3;
temp = ((seed >> 16) & 0xff);
if(temp < 0x10)
pkey[j].value += "0" + temp.toString(16).toUpperCase();
else
pkey[j].value += temp.toString(16).toUpperCase();
}
}
$('wep_key_no1').checked = true;
}
function PassPhrase104()
{
var pseed2 = "";
Length2 = $('passphraseStr').value.length;
var asciiObj = "";
for(p=0; p<64; p++)
{
tempCount = p % Length2;
pseed2 += $('passphraseStr').value.substring(tempCount, tempCount+1);
}
md5Str = calcMD5(pseed2);
$('KEY1').value = md5Str.substring(0, 26).toUpperCase();
$('KEY2').value = $('KEY1').value;
$('KEY3').value = $('KEY1').value;
$('KEY4').value = $('KEY1').value;
$('wep_key_no1').checked = true;
}
function dealWithError(){
if (G_Error != 1){
return false;
}
var arrayHint = [];
dealErrorMsg(arrayHint, G_Error_Msg);
}
addListeners(uiOnload);
-->
</script>
<body id="real_page" >
<!-- config -->
<form id="uiPostForm" method="post" action="WLG_wireless_guest.htm"></form>
<style type="text/css"><!--
td {
font-family:Arial,Helvetica,Geneva,Swiss,SunSans-Regular,sans-serif;
font-size:12px;
}
.subhead {
-moz-background-clip:border;
-moz-background-inline-policy:continuous;
-moz-background-origin:padding;
background:white none repeat scroll 0 0;
color:#0099CC;
font-family:Arial,Helvetica,Geneva,Swiss,SunSans-Regular,sans-serif;
font-size:12px;
font-weight:bold;
}
select {
font-family:Arial,Helvetica,Geneva,Swiss,SunSans-Regular,sans-serif;
font-size:12px;
}
input[type=text] {
font-family:Arial,Helvetica,Geneva,Swiss,SunSans-Regular,sans-serif;
font-size:12px;
letter-spacing:1px;
}
-->
</style>
<script type="text/javascript" src="js/md5.js"></script>
<div class="page_title" id="lang_GuestSettings">Guest Network Settings</div>
<div class="fix_button">
<TABLE width=100% border=0 cellpadding=0 cellspacing=2>
<TR>
<TD nowrap colspan=2 align=center>
<input class="cancel_bt" type="button" id="Cancel" name="Cancel" value="Cancel"/>&nbsp;&nbsp;
<input class="apply_bt" type="button" id="Apply" name="Apply" value="Apply" onClick="uiSubmit();"/>
</TD>
</TR>
</TABLE>
</div>
<div id="main" class="main">
<table class="content" style="background:white; width:100%;">
<tr>
<td class="mainFramWidth">
<div class="config3">
<table width="100%" border="0" cellpadding="0" cellspacing="3">
<tbody>
<tr style="display:none; ">
<td nowrap="" colspan="2">
<table width="100%" border="1" cellpadding="0" align="center" class="td_table_s3">
<tr>
<td nowrap="" class="subhead">&nbsp;</td>
<td nowrap="" class="subhead"><div align="center" id="lang_Scheme">Scheme</div></td>
<td nowrap="" class="subhead"><div align="center" id="lang_SSID">SSID</div></td>
<td nowrap="" class="subhead"><div align="center" id="lang_Security">Security</div></td>
<td nowrap="" class="subhead"><div align="center" id="lang_Apply">Apply</div></td>
<td nowrap="" class="subhead"><div align="center" id="lang_BroadcastSSID">SSID Broadcast</div></td>
</tr>
<tr>
<td><input type="radio" name="guestID" value="1" onClick="SelectProfile(1);"></td>
<td><div align="center">1</div></td>
<td><div align="center" id="SSID_1"></div></td>
<td><div align="center" id="Security_1"></div></td>
<td><div align="center" id="W_Enable_1"></div></td>
<td><div align="center" id="Advertisement_1"></div></td>
</tr>
<tr>
<td><input type="radio" name="guestID" value="2" onClick="SelectProfile(2);"></td>
<td><div align="center">2</div></td>
<td><div align="center" id="SSID_2"></div></td>
<td><div align="center" id="Security_2"></div></td>
<td><div align="center" id="W_Enable_2"></div></td>
<td><div align="center" id="Advertisement_2"></div></td>
</tr>
<tr>
<td><input type="radio" name="guestID" value="3" onClick="SelectProfile(3);"></td>
<td><div align="center">3</div></td>
<td><div align="center" id="SSID_3"></div></td>
<td><div align="center" id="Security_3"></div></td>
<td><div align="center" id="W_Enable_3"></div></td>
<td><div align="center" id="Advertisement_3"></div></td>
</tr>
<tr>
<td><input type="radio" name="guestID" value="4" onClick="SelectProfile(4);"></td>
<td><div align="center">4</div></td>
<td><div align="center" id="SSID_4"></div></td>
<td><div align="center" id="Security_4"></div></td>
<td><div align="center" id="W_Enable_4"></div></td>
<td><div align="center" id="Advertisement_4"></div></td>
</tr>
</table>
</td>
</tr>
<tr>
<td nowrap="" colspan="2"><a href="javascript:loadhelp('network')"><p style="font-weight:bold;padding:0px 0px 5px;"><span id="lang_Profile_wireless"></span><span id="Profile_wirelessnum" style="display:none;"></span></p></a></td>
</tr>
<tr>
<td nowrap="" colspan="2"><input type="checkbox" id="enable_bssid" name="enable_bssid" value="enable_bssid"><span id="lang_EnableGuestNetwork">Enable Guest Network</span></td>
</tr>
<tr>
<td nowrap="" colspan="2"><input type="checkbox" id="enable_ssid_bc" name="enable_ssid_bc" value="enable_ssid_bc"><span id="lang_EnableSSIDBroadcast">Enable SSID Broadcast</span></td>
</tr>
<tr>
<td nowrap="" colspan="2"><input type="checkbox" id="allow_access" name="allow_access" value="allow_access"><span id="lang_AllowGuest">Allow Guest to access My Local Network</span></td>
</tr>
<tr>
<td nowrap="" colspan="2"><input type="checkbox" id="wlan_iso" name="wlan_iso"><span id="lang_EnableIsolation">Enable Wireless Isolation</span></td>
</tr>
<tr>
<td nowrap="" width="40%"><span id="lang_GuestName">Guest Wireless Network Name(SSID):</span></td>
<td nowrap=""><input type="text" id="ssid" name="ssid" value="NETGEAR_Guest" maxlength="32"></td>
</tr>
<tr>
<td nowrap="" colspan="2"><a href="javascript:loadhelp('security')"><p class="do bk_black3_black"><span id="lang_Profile_securitynum"></span><span id="Profile_securitynum" style="display:none;"></span></p></a></td>
</tr>
<tr>
<td nowrap="" colspan="2">
<div><input type="radio" value="Disable" checked="checked" id="RADIO_None" name="security_type" onClick="SecuritySelect(this.value)" /><span id="RADIO_NoneContext">None</span></div>
<div><input type="radio" value="WEP" id="RADIO_Wep" name="security_type" onClick="SecuritySelect(this.value)" /><span id="RADIO_WepContext">WEP</span></div>
<div><input type="radio" value="WPA-PSK" id="RADIO_Tkip" name="security_type" onClick="SecuritySelect(this.value)" /><span id="RADIO_TkipContext">WPA-PSK[TKIP]</span></div>
<div><input type="radio" value="WPA2-PSK" id="RADIO_Aes" name="security_type" onClick="SecuritySelect(this.value)" /><span id="RADIO_AesContext">WPA2-PSK[AES]</span></div>
<div><input type="radio" value="AUTO-PSK" id="RADIO_TkipAes" name="security_type" onClick="SecuritySelect(this.value)" /><span id="RADIO_TkipAesContext">WPA-PSK[TKIP]+WPA2-PSK[AES]</span></div>
</td>
</tr>
<tr id="module_wep1">
<td nowrap="" colspan="2"><a href="javascript:loadhelp('wep')"><p class="do bk_black3_black" id="lang_SecurityEncryptionWep">Security Encryption(WEP)</p></a></td>
</tr>
<tr id="module_wep2">
<td nowrap="" width="40%"><span id="lang_AuthenticationType">Authentication Type :</span></td>
<td nowrap=""><select id="authAlgm" name="authAlgm">
<option value="automatic" id="lang_automatic">Automatic</option>
<!--<option value="open" id="lang_open">Open System</option>-->
<option value="sharedkey" id="lang_shared">Shared Key</option>
</select>
</td>
</tr>
<tr id="module_wep3">
<td nowrap="" width="40%"><span id="lang_EncryptionStrength">Encryption Strength :</span></td>
<td nowrap=""><select id="wepenc" name="wepenc" onChange="setKeys();" size="1">
<option value="1" id="lang_length64">64 bits</option>
<option value="2" id="lang_length128">128 bits</option>
</select>
</td>
</tr>
<tr id="module_wep4">
<td nowrap="" colspan="2"><a href="javascript:loadhelp('wepkey')"><p class="do bk_black3_black" id="lang_SecurityEncryptionWepKey">Security Encryption(WEP) Key</p></a></td>
</tr>
<tr id="module_wep5">
<td nowrap colspan="2">
<span id="lang_passphraseStr">Passphrase: </span><input type="text" id="passphraseStr" name="passphraseStr" size="14" maxlength="32" value=""> &nbsp;
<input type="button" id="Generate" class="short_common_bt" name="Generate" value="Generate" onClick="calcPassphrase()">
</td>
</tr>
<tr>
<TD nowrap colspan=2>
<TABLE>
<tr id="module_wep6">
<td nowrap=""><span id="lang_key1">Key1</span><input type="radio" name="wep_key_no" id="wep_key_no1" value="1"></td>
<td nowrap=""><input type="text" id="KEY1" name="KEY1" size="34"></td>
</tr>
<tr id="module_wep7">
<td nowrap="" ><span id="lang_key2">Key2</span><input type="radio" name="wep_key_no" id="wep_key_no2" value="2"></td>
<td nowrap=""><input type="text" id="KEY2" name="KEY2" size="34"></td>
</tr>
<tr id="module_wep8">
<td nowrap=""><span id="lang_key3">Key3</span><input type="radio" name="wep_key_no" id="wep_key_no3" value="3"></td>
<td nowrap=""><input type="text" id="KEY3" name="KEY3" size="34"></td>
</tr>
<tr id="module_wep9">
<td nowrap=""><span id="lang_key4">Key4</span><input type="radio" name="wep_key_no" id="wep_key_no4" value="4"></td>
<td nowrap=""><input type="text" id="KEY4" name="KEY4" size="34"></td>
</tr>
</table>
</td>
</tr>
<tr id="module_tkip1">
<td nowrap="" colspan="2"><a href="javascript:loadhelp('wpa-psk')"><p class="do bk_black3_black" id="lang_SecurityOptionsWpaPsk">Security Options(WPA-PSK)</p></a></td>
</tr>
<tr id="module_aes1">
<td nowrap="" colspan="2"><a href="javascript:loadhelp('wpa2-psk')"><p class="do bk_black3_black" id="lang_SecurityOptionsWpa2Psk">Security Options(WPA2-PSK)</p></a></td>
</tr>
<tr id="module_tkipaes1">
<td nowrap="" colspan="2"><a href="javascript:loadhelp('wpa-psk+wpa2-psk')"><p class="do bk_black3_black" id="lang_SecurityOptionsWpaPskWpa2Psk">Security Options(WPA-PSK+WPA2-PSK)</p></a></td>
</tr>
<tr id="module_passphrase1">
<td nowrap="" width="40%"><span id="lang_PassPhraseWpaPskWpa2Psk">PassPhrase :</span></td>
<td nowrap=""><input type="text" id="passphrase" name="passphrase" size="20" maxlength="64" style="width:auto "><span id="lang_charactersWpaPskWpa2Psk">(8-63 characters or 64 hexdigits)</span></td>
</tr>
<tr>
<td nowrap="" colspan="2"><p class="do bk_black3_black">&nbsp;&nbsp;</p></td>
</tr>
</tbody>
</table>
</div><!--end of config3-->
</td>
</tr>
</table>
</div>
<div id="help" style="display: none; left:0px;">
<iframe name="helpframe" id="helpframe" src="help.htm" allowtransparency="true" width="100%" frameborder="0" >
</iframe>
</div>
<div id="help_switch" class="close_help" style="">
<img class="help_switch_img" src="skin/image/help/help-bar.gif">
<script>
var help_flag=0;
function help_brower()
{
if(isIE()){
show_hidden_help_top_button(1);
var frame_div = top.document.getElementById("formframe_div");
frame_div.onresize = function(){
if( help_flag == 0 )
show_hidden_help_top_button(1);
else{
show_hidden_help_top_button(--help_flag);
help_flag++;
}
};
}
if(get_browser() == "Opera"){
window.onresize = function(){
if( help_flag == 0 )
show_hidden_help_top_button(1);
else{
show_hidden_help_top_button(--help_flag);
help_flag++;
}
};
}
}
var wl_erase = "-"
switch("WLG_wireless_guest")
{
case "RST_status":
case "basic_home":self.document.getElementById("real_page").style.backgroundColor = '#e5e5e5';
case "BAK_cfm":
case "WIZ_cfm":
/****************************************************************/
/*升级模块*/
case "AUTO_search":
case "AUTO_upgrade_no_internet":
case "AUTO_upgrade_noversion":
case "AUTO_upgrade_process":
case "UpdateCheck":
case "UPG_check_version":
/****************************************************************/
case "Reboot":
case "BRS_checkNet":
case "BRS_success":
case "BRS_genieHelp":
case "BRS_haveBackupFile":
case "WIZ_fix":
case "WIZ_wait":
case "AUTO_download_image":
case "updataGui":
case "traffic_alert":
self.document.getElementById("help_switch").style.display="none";
break;
default:
self.document.getElementById("help_switch").style.display="";
help_brower();
break;
}
</script>
<div id="help_space" onClick="show_hidden_help_top_button(help_flag); help_flag++;"></div>
<div id="help_center"><span id="lang_help_center">Help Center</span></div>
<div id="help_button" onClick="show_hidden_help_top_button(help_flag); help_flag++;"></div>
<div id="help_show_hidden"><a href="javascript:void(0)" onClick="show_hidden_help_top_button(help_flag); help_flag++;"><span id="lang_show_or_hide">Show/Hide Help Center</span></a></div>
</div>
</body>