<html>
<head>
<meta name="description" content="Belkin 2307">

<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<link rel="stylesheet" href="styles.css" type="text/css">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"><script language="Javascript" src='language_en.js'></script><script language="JavaScript" src="showmenu.js"></script>
<script language="JavaScript" src="validate.js"></script>
<script language="javascript" type="text/javascript" src="linuxs.js"></script>
<script language="javascript" type="text/javascript">
strHtml='<title>'+wppa1+'</title>';
dw(strHtml);
<!--
var wanStatus	='Down';
var helpItem 	='Connection Type';
var menuSection	='WAN';
var menuItem	='Connection Type';
var isRouter	='1' ? '1' : '0';
var	isPS		='' ? '' : '0';
var isAPmode
if('vlan1' =='' || '1'=='0')
	isAPmode='1';
else
	isAPmode='0';

function evaltF()
{
    var cf = document.wan_form;
	if(isBlank(cf.pptpUserName.value))
	{
	 	cf.pptpUserName.focus();
	 	cf.pptpUserName.select();
		alert(wppa13);
		return false;
	}
	if(!validVisibleStr(cf.pptpUserName.value))
    {
        cf.pptpUserName.focus();
	 	cf.pptpUserName.select();
        alert(msg_invalid_char);
        return false;
    }
	if(isBlank(cf.pptpPasswd.value))
	{
		cf.pptpPasswd.focus();
		cf.pptpPasswd.select();
		alert(pm);
		return false;
	}
	if(!validVisibleStr(cf.pptpPasswd.value))
    {
        cf.pptpPasswd.focus();
		cf.pptpPasswd.select();
        alert(msg_invalid_char);
        return false;
    }
	if(isBlank(cf.pptp_password_2.value))
	{
		cf.pptp_password_2.focus();
		cf.pptp_password_2.select();
		alert(wpp14);
		return false;
	}
	if(cf.pptpPasswd.value!=cf.pptp_password_2.value)
	{
		cf.pptp_password_2.focus();
		cf.pptp_password_2.select();
		alert(pm);
		return false;
	}
	if(!validVisibleStr(cf.pptp_hostname.value))
    {
        cf.pptp_hostname.focus();
        cf.pptp_hostname.select();
        alert(msg_invalid_char);
        return false;
    }

	if(isNValidSingleFirstIP(cf.pptp_server_1.value))
	{
		cf.pptp_server_1.focus();
	 	cf.pptp_server_1.select();
		alert(usysipm);
		return false;
	}
	if(isLoopBackFirstIP(cf.pptp_server_1.value))
	{
		cf.pptp_server_1.focus();
	 	cf.pptp_server_1.select();
		alert(lsipm4);
		return false;
	}
	if(isNValidIP(cf.pptp_server_2.value))
	{
		cf.pptp_server_2.focus();
	 	cf.pptp_server_2.select();
		alert(usysipm);
		return false;
	}
	if(isNValidIP(cf.pptp_server_3.value))
	{
		cf.pptp_server_3.focus();
	 	cf.pptp_server_3.select();
		alert(usysipm);
		return false;
	}
	if(isNValidEndIP(cf.pptp_server_4.value))
	{
		cf.pptp_server_4.focus();
	 	cf.pptp_server_4.select();
		alert(usysipm);
		return false;
	}

if(document.forms[0].ip_mode_pptp.value == 1)
{
	if(isNValidSingleFirstIP(cf.pptp_ip_1.value))
	{
		cf.pptp_ip_1.focus();
	 	cf.pptp_ip_1.select();
		alert(usysipm);
		return false;
	}
	
	if(isLoopBackFirstIP(cf.pptp_ip_1.value))
	{
		cf.pptp_ip_1.focus();
	 	cf.pptp_ip_1.select();
		alert(lsipm4);
		return false;
	}
	
	if(isNValidIP(cf.pptp_ip_2.value))
	{
		cf.pptp_ip_2.focus();
	 	cf.pptp_ip_2.select();
		alert(usysipm);
		return false;
	}
	if(isNValidIP(cf.pptp_ip_3.value))
	{
		cf.pptp_ip_3.focus();
	 	cf.pptp_ip_3.select();
		alert(usysipm);
		return false;
	}
	if(isNValidEndIP(cf.pptp_ip_4.value))
	{
		cf.pptp_ip_4.focus();
	 	cf.pptp_ip_4.select();
		alert(usysipm);
		return false;
	}
    if(isNValidIP(cf.pptp_mask_1.value) )
	{
		cf.pptp_mask_1.focus();
	 	cf.pptp_mask_1.select();
		alert(sm);
		return false;
	}
    if(isNValidIP(cf.pptp_mask_2.value))
	{
		cf.pptp_mask_2.focus();
	 	cf.pptp_mask_2.select();
		alert(sm);
		return false;
	}
    if(isNValidIP(cf.pptp_mask_3.value))
	{
		cf.pptp_mask_3.focus();
	 	cf.pptp_mask_3.select();
		alert(sm);
		return false;
	}
    if(isNValidIP(cf.pptp_mask_4.value))
	{
		cf.pptp_mask_4.focus();
	 	cf.pptp_mask_4.select();
		alert(sm);
		return false;
	}

	if(badMask(cf.pptp_mask_1, cf.pptp_mask_2, cf.pptp_mask_3, cf.pptp_mask_4))
	{
	    alert(sm);
	    return false;
	}

	{ /* check subnet */
	    var myIp, subnetMask, serverIp;

	    myIp = hex(cf.pptp_ip_1.value)
	            + hex(cf.pptp_ip_2.value)
	            + hex(cf.pptp_ip_3.value)
	            + hex(cf.pptp_ip_4.value);

	    serverIp = hex(cf.pptp_server_1.value)
	                + hex(cf.pptp_server_2.value)
	                + hex(cf.pptp_server_3.value)
	                + hex(cf.pptp_server_4.value);

	    subnetMask = hex(cf.pptp_mask_1.value)
	                  + hex(cf.pptp_mask_2.value)
	                  + hex(cf.pptp_mask_3.value)
	                  + hex(cf.pptp_mask_4.value);

	    if((parseInt(myIp, 16) & parseInt(subnetMask, 16)) != (parseInt(serverIp, 16) & parseInt(subnetMask, 16)))
	    {
	        alert(msg_wan_stat1
	                + cf.pptp_ip_1.value + '.'
	                + cf.pptp_ip_2.value + '.'
	                + cf.pptp_ip_3.value + '.'
	                + cf.pptp_ip_4.value
	                + msg_wan_stat2
	                + cf.pptp_server_1.value + '.'
	                + cf.pptp_server_2.value + '.'
	                + cf.pptp_server_3.value + '.'
	                + cf.pptp_server_4.value
	                + '/'
	                + cf.pptp_mask_1.value + '.'
	                + cf.pptp_mask_2.value + '.'
	                + cf.pptp_mask_3.value + '.'
	                + cf.pptp_mask_4.value
	                + msg_wan_stat3);

	        return false;
}
	    }
	}

	if(!validVisibleStr(cf.pptp_conn_id.value))
    {
        cf.pptp_conn_id.focus();
		cf.pptp_conn_id.select();
        alert(msg_invalid_char);
        return false;
    }

	if(cf.pptpDODC.checked==true)
	{
     	 if((isBlank(cf.pptpIdleTime.value))
     	 ||(isNaN(cf.pptpIdleTime.value))
     	 ||(cf.pptpIdleTime.value<1||cf.pptpIdleTime.value>99))
  		 {
  		 	alert(idlerangerro);
  		 	cf.pptpIdleTime.focus();
  		 	cf.pptpIdleTime.select();
  		 	return false;
  		 }
	}

	cf.pptp_server_ipaddr.value=cf.pptp_server_1.value+'.'+cf.pptp_server_2.value+'.'+cf.pptp_server_3.value+'.'+cf.pptp_server_4.value;
	cf.pptp_ipaddr.value=cf.pptp_ip_1.value+'.'+cf.pptp_ip_2.value+'.'+cf.pptp_ip_3.value+'.'+cf.pptp_ip_4.value;
	cf.pptp_netmask.value=cf.pptp_mask_1.value+'.'+cf.pptp_mask_2.value+'.'+cf.pptp_mask_3.value+'.'+cf.pptp_mask_4.value;

    dataToHidden(document.forms[0]);

    return true;
}

function connect()
{
  	if(evaltF())
  	{
	   	document.wan_form.submit();
	   	return true;
  	}
  	return false;
}

function disconnect()
{
  	if( evaltF())
  	{
	  	document.wan_form.submit();
		return true;
  	}
   	return false;
}

function submitF()
{
  	if( evaltF())
  	{
      	alert(ur5);
	  	return true;
  	}
   	return false;
}
function logoutF()
{
	document.wan_form.logout.value=1;
	document.wan_form.submit();
	return true;
}
function nextF()
{
    document.wan_form.webpage.value="wan_dns.html";
    if(!evaltF())
    {
        document.wan_form.webpage.value="wan_pptp.html";
        return false;
    }
   	return true;
}
function toggleAutoDLS()
{
    var cf = document.wan_form;
  	if(cf.pptpDODC.checked)
  	{
     		cf.pptpIdleTime.disabled = false;
  	}
  	else
  	{
  		cf.pptpIdleTime.disabled = true;

    }
}

function set_dynamic()
{
    var cf = document.forms[0];
    cf.pptp_ip_1.disabled = cf.pptp_ip_2.disabled = cf.pptp_ip_3.disabled = cf.pptp_ip_4.disabled = (cf.ip_mode_pptp.selectedIndex == 0);
    cf.pptp_mask_1.disabled = cf.pptp_mask_2.disabled = cf.pptp_mask_3.disabled = cf.pptp_mask_4.disabled = (cf.ip_mode_pptp.selectedIndex == 0);
}

function clean_myip()
{
	if(document.wan_form.wan_proto.value!="pptp")
	{
		document.wan_form.pptp_ip_1.value="";
		document.wan_form.pptp_ip_2.value="";
		document.wan_form.pptp_ip_3.value="";
		document.wan_form.pptp_ip_4.value="";
		document.wan_form.pptp_mask_1.value="";
		document.wan_form.pptp_mask_2.value="";
		document.wan_form.pptp_mask_3.value="";
		document.wan_form.pptp_mask_4.value="";
	}
}
-->
</script>
</head>
<body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" onLoad="dataToVisible(document.wan_form);clean_myip();toggleAutoDLS();set_dynamic();">
<form id="wan_form" name="wan_form" method=post action="apply_40.html" >
<input type=hidden name="webpage" value=wan_pptp.html>
<input type=hidden name="action" value="">
<input type=hidden name="wan_access" value="">
<input type=hidden name="wan_proto" value="">
<input type=hidden name="et1macaddr" value="">
<input type=hidden name="m_wan_hostname" value="" >
<input type=hidden name="pptp_server_ipaddr" value="">
<input type=hidden name="pptp_ipaddr" value="">
<input type=hidden name="pptp_netmask" value="">
<input type=hidden name="m_wan_aliasip" value="">
<script language="javascript" type="text/javascript">
showHead(wanStatus,helpItem,isRouter,isPS);
showmenu(menuSection,menuItem,isRouter,isPS,isAPmode)
</script>
<td valign="top" width="99%" height="100%" class="head_bold"><br>&nbsp;&nbsp;<script language="javascript" type="text/javascript">dw(wppa1);</script><br><br>
<table border=0 class="copy_1">
<tr><td width=5>&nbsp;</td>
<td><table width=600 border="0" cellspacing="5" cellpadding="0" align=left class="copy_1">
<tr><td width="36">
<td><a class="more" href="javascript:void(0);" onClick="window.open('glossary.html#pptp','help','toolbar=0,status=0,menubar=0,scrollbars=1,resizable=1,width=530,height=400,left=150,top=150');">
<script language="javascript" type="text/javascript">dw(sm1);</script></a><br><br></td>

</tr>
<tr><td width="36">&nbsp;</td><td width="174" class="bold_body"><script language="javascript" type="text/javascript">dw(wppa2);</script> &gt;</td>
<td width="235" class="plaintext_bold"><input type="text" name="pptpUserName" size="25" maxlength="63" value=""></td>
</tr><tr><td width="36">&nbsp;</td><td width="174" class="bold_body"><script language="javascript" type="text/javascript">dw(wpp3);</script> &gt;</td>
	<td class="plaintext_bold" width="235">
	<input type="password" name="pptpPasswd" size="25" maxlength="63" value="">
	</td>
	</tr><tr><td width="36" height="18">&nbsp;</td><td height="18" width="174" class="bold_body"><script language="javascript" type="text/javascript">dw(wpp4);</script> &gt;</td>
	<td class="plaintext_bold" height="18" width="235">
	<input type="password" name="pptp_password_2" size="25" maxlength="63" value=""></td>
	</tr><tr><td width="36">&nbsp;</td><td width="174" class="bold_body"><script language="javascript" type="text/javascript">dw(wppa5);</script> &gt;</td>
	<td class="plaintext_bold" width="235">
	<input type="text" name="pptp_hostname" size="25" maxlength="39" value=""></td>
	</tr><tr><td width="36" height="27">&nbsp;</td>
	<td width="174" height="27" class="bold_body"><script language="javascript" type="text/javascript">dw(wppa6);</script> &gt;</td><td class="plaintext_bold" width="280" height="27">
	<input type="text" name="pptp_server_1" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_server_2" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_server_3" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_server_4" size="3" maxlength="3" value="">
	</td></tr>
	<tr>
	<td width="36">&nbsp;</td><td width="174" class="body"><b><script language="javascript" type="text/javascript">dw(wpp20);</script> &gt;</b></td>
	<td class="plaintext_bold" width="235" class="body">
    <select name="ip_mode_pptp" onChange="set_dynamic();">
	      <option value="0"><script language="javascript" type="text/javascript">dw(wpp21);</script></option>
          <option value="1"><script language="javascript" type="text/javascript">dw(wpp22);</script></option>
    </select>
    </td>
	</tr>
	<tr>
	<td width="36">&nbsp;</td><td width="174" class="body"><b><script language="javascript" type="text/javascript">dw(wppa7);</script> &gt;</b></td>
	<td class="plaintext_bold" width="280" height="27">
	<input type="text" name="pptp_ip_1" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_ip_2" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_ip_3" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_ip_4" size="3" maxlength="3" value="">
	</td></tr>
	<tr><td width="36" height="27">&nbsp;</td><td width="174" height="27" class="bold_body"><script language="javascript" type="text/javascript">dw(wppa8);</script> &gt;</td>
	<td class="plaintext_bold" width="280" height="27">
	<input type="text" name="pptp_mask_1" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_mask_2" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_mask_3" size="3" maxlength="3" value="">.
	<input type="text" name="pptp_mask_4" size="3" maxlength="3" value="">
	</td></tr>
	<tr><td width="36" height="27">&nbsp;</td><td width="174" height="27" class="bold_body"><b><script language="javascript" type="text/javascript">dw(wppa9);</script> &gt;</b></td>
	<td class="plaintext_bold" width="235" height="27">
	<input type="text" name="pptp_conn_id" size="23" maxlength="23" value="">
	</td></tr>
	<tr><td width="5">&nbsp;</td><td class="body" colspan="2">
	<input type="checkbox" name="pptpDODC" value="pptp_idle" onClick="toggleAutoDLS();"  ><b><script language="javascript" type="text/javascript">dw(wppa10);</script>
	<input type="text" name="pptpIdleTime" size="10" maxlength="2" value="5"><script language="javascript" type="text/javascript">dw(wppa11);</script></b>&nbsp;<a class="more" href="javascript:void(0);" class="plaintext_bold" onClick="window.open('glossary.html#disconnect','help','toolbar=0,status=0,menubar=0,scrollbars=1,resizable=1,width=530,height=400,left=150,top=150');"><script language="javascript" type="text/javascript">dw(sm1);</script></a></td>
	</tr>
	<tr><td width="36">&nbsp;</td><td class="formText" width="409" colspan="2">
	<div align="center"><a class="more" href="wan_dns.html" onClick="return nextF();"><script language="javascript" type="text/javascript">dw(wppa12);</script></a></div>&nbsp;</td>
	</tr><tr>
	<td width="36">&nbsp;</td><td class="plaintext_bold"><div align="right"></div></td>
	<td align="center"><br><br>
	<script language="javascript" type="text/javascript">dw('<input type="button" name="cancel" value="');dw(btn1);dw('" style="{width:160px;}" class="submitBtn" onMouseOver="window.status=\'Clear\'; return true;" onMouseOut="window.status=\'\'; return true;" onClick="location.href=\'wan_pptp.html\'; return true;">&nbsp;&nbsp;');
	dw('<input type="submit" name="itsbutton1" value="');dw(btn2);dw('" style="{width:160px;}" class="submitBtn" onClick="return submitF();"></td>');</script>
	</tr></table>
	</td></tr>
	</table></td>
<input type="hidden" name="h_ip_mode_pptp" value="0">
<input type="hidden" name="h_pptpDODC" value="disable">
</form>
<script language="javascript" type="text/javascript">showTail()</script>
