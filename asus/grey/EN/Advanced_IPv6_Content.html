<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<html xmlns:v>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta HTTP-EQUIV="Pragma" CONTENT="no-cache">
<meta HTTP-EQUIV="Expires" CONTENT="-1">
<link rel="shortcut icon" href="images/favicon.png">
<link rel="icon" href="images/favicon.png">
<title>ASUS Wireless Router RT-AC66U - IPv6</title>
<link rel="stylesheet" type="text/css" href="index_style.css"> 
<link rel="stylesheet" type="text/css" href="form_style.css">
<link rel="stylesheet" type="text/css" href="other.css">
<script type="text/javascript" src="state.js"></script>
<script type="text/javascript" src="general.js"></script>
<script type="text/javascript" src="popup.js"></script>
<script type="text/javascript" src="help.js"></script>
<script type="text/javascript" src="detect.js"></script>
<script language="JavaScript" type="text/JavaScript" src="jquery.js"></script>
<script>

function is_logined() { return 1; }
function login_ip_dec() { return '2785126592'; }
function login_ip_str() { return '192.168.1.166'; }
function login_ip_str_now() { return '192.168.1.166'; }
function login_mac_str() { return '50:e5:49:a2:00:f8'; }



var wireless = [];	// [[MAC, associated, authorized], ...]
var wan_proto_orig = 'dhcp';
var ipv6_proto_orig = 'disabled';
var ipv6_tun6rd_dhcp = '1';
var ipv6_dnsenable = '1'; 
var wan0_ipaddr = '192.168.66.210'; 
var machine_name = 'armv7l';
var machine_arm = (machine_name.search("arm") == -1) ? false : true;

var $j = jQuery.noConflict();



function initial(){
	show_menu();	
	showInputfield(ipv6_proto_orig);
	addOnlineHelp($("faq"), ["ASUSWRT", "IPv6"]);	
}

function showInputfield(v){
	
	if(v == "static6"){
		if(wan_proto_orig == "l2tp" || wan_proto_orig == "pptp" || wan_proto_orig == "pppoe")
			inputCtrl(document.form.ipv6_ifdev_select, 1);
		else	
			inputCtrl(document.form.ipv6_ifdev_select, 0);
		inputCtrl(document.form.ipv6_tun_v4end, 0);
		inputCtrl(document.form.ipv6_relay, 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[0], 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[1], 0);
		inputCtrl(document.form.ipv6_6rd_prefix, 0);
		inputCtrl(document.form.ipv6_6rd_prefixlen, 0);
		inputCtrl(document.form.ipv6_6rd_router, 0);
		inputCtrl(document.form.ipv6_6rd_ip4size, 0);
		inputCtrl(document.form.ipv6_tun_addr, 0);
		inputCtrl(document.form.ipv6_tun_addrlen, 0);
		inputCtrl(document.form.ipv6_tun_mtu, 0);
		inputCtrl(document.form.ipv6_tun_ttl, 0);
		$("ipv6_wan_setting").style.display="none";
		inputCtrl(document.form.ipv6_ipaddr, 0);
		inputCtrl(document.form.ipv6_prefix_len_wan, 0);
		inputCtrl(document.form.ipv6_gateway, 0);
		$("ipv6_lan_setting").style.display="";
		inputCtrl(document.form.ipv6_prefix, 1);
		inputCtrl(document.form.ipv6_prefix_length, 1);		
		$("ipv6_prefix_r").style.display="none";
		$("ipv6_prefix_length_r").style.display="none";
		inputCtrl(document.form.ipv6_rtr_addr, 1);
		if(v != ipv6_proto_orig){
				document.form.ipv6_prefix.value = "";
				document.form.ipv6_prefix_length.value = "";
				document.form.ipv6_rtr_addr.value = "";
		}else{
				document.form.ipv6_prefix.value = "";
				document.form.ipv6_prefix_length.value = "64";
				document.form.ipv6_rtr_addr.value = "";
		}
		$("ipv6_ipaddr_r").style.display="none";
		$("ipv6_dns_setting").style.display="";
		inputCtrl(document.form.ipv6_dnsenable[0], 0);
		inputCtrl(document.form.ipv6_dnsenable[1], 0);
		inputCtrl(document.form.ipv6_dns1, 1);
		inputCtrl(document.form.ipv6_dns2, 1);
		inputCtrl(document.form.ipv6_dns3, 1);
		
	}
	else if(v == "dhcp6"){
		if(wan_proto_orig == "l2tp" || wan_proto_orig == "pptp" || wan_proto_orig == "pppoe")
			inputCtrl(document.form.ipv6_ifdev_select, 1);
		else	
			inputCtrl(document.form.ipv6_ifdev_select, 0);
		inputCtrl(document.form.ipv6_tun_v4end, 0);
		inputCtrl(document.form.ipv6_relay, 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[0], 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[1], 0);
		inputCtrl(document.form.ipv6_6rd_prefix, 0);
		inputCtrl(document.form.ipv6_6rd_prefixlen, 0);
		inputCtrl(document.form.ipv6_6rd_router, 0);
		inputCtrl(document.form.ipv6_6rd_ip4size, 0);
		inputCtrl(document.form.ipv6_tun_addr, 0);
		inputCtrl(document.form.ipv6_tun_addrlen, 0);
		inputCtrl(document.form.ipv6_tun_mtu, 0);
		inputCtrl(document.form.ipv6_tun_ttl, 0);
		$("ipv6_wan_setting").style.display="none";
		inputCtrl(document.form.ipv6_ipaddr, 0);
		inputCtrl(document.form.ipv6_prefix_len_wan, 0);
		inputCtrl(document.form.ipv6_gateway, 0);		
		$("ipv6_lan_setting").style.display="";
		inputCtrl(document.form.ipv6_prefix, 0);
		inputCtrl(document.form.ipv6_prefix_length, 0);
		$("ipv6_prefix_r").style.display="";
		$("ipv6_prefix_length_r").style.display="";
		inputCtrl(document.form.ipv6_rtr_addr, 0);
		$("ipv6_ipaddr_r").style.display="";
		if(v != ipv6_proto_orig){
				$("ipv6_prefix_span").innerHTML = "";
				$("ipv6_prefix_length_span").innerHTML = "";			
				$("ipv6_ipaddr_span").innerHTML = "";
		}else{
				$("ipv6_prefix_span").innerHTML = "";
				$("ipv6_prefix_length_span").innerHTML = "64";
				$("ipv6_ipaddr_span").innerHTML = "";
		}		
		$("ipv6_dns_setting").style.display="";
		inputCtrl(document.form.ipv6_dnsenable[0], 1);
		inputCtrl(document.form.ipv6_dnsenable[1], 1);
		if(ipv6_dnsenable==1){
				inputCtrl(document.form.ipv6_dns1, 0);
				inputCtrl(document.form.ipv6_dns2, 0);
				inputCtrl(document.form.ipv6_dns3, 0);
		}else{
				inputCtrl(document.form.ipv6_dns1, 1);
				inputCtrl(document.form.ipv6_dns2, 1);
				inputCtrl(document.form.ipv6_dns3, 1);			
		}		
		
	}
	else if(v == "6to4"){
		inputCtrl(document.form.ipv6_ifdev_select, 0);
		inputCtrl(document.form.ipv6_tun_v4end, 0);
		inputCtrl(document.form.ipv6_relay, 1);
		inputCtrl(document.form.ipv6_6rd_dhcp[0], 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[1], 0);
		inputCtrl(document.form.ipv6_6rd_prefix, 0);
		inputCtrl(document.form.ipv6_6rd_prefixlen, 0);
		inputCtrl(document.form.ipv6_6rd_router, 0);
		inputCtrl(document.form.ipv6_6rd_ip4size, 0);
		inputCtrl(document.form.ipv6_tun_addr, 0);
		inputCtrl(document.form.ipv6_tun_addrlen, 0);
		inputCtrl(document.form.ipv6_tun_mtu, 1);
		inputCtrl(document.form.ipv6_tun_ttl, 1);
		$("ipv6_wan_setting").style.display="none";
		inputCtrl(document.form.ipv6_ipaddr, 0);
		inputCtrl(document.form.ipv6_prefix_len_wan, 0);
		inputCtrl(document.form.ipv6_gateway, 0);		
		$("ipv6_lan_setting").style.display="";
		inputCtrl(document.form.ipv6_prefix, 0);
		inputCtrl(document.form.ipv6_prefix_length, 0);
		$("ipv6_prefix_r").style.display="";
		$("ipv6_prefix_length_r").style.display="";
		var calc_hex = calcIP6(wan0_ipaddr);
		$("ipv6_prefix_span").innerHTML="2002:"+calc_hex+"::";
		$("ipv6_prefix_length_span").innerHTML="48";
		inputCtrl(document.form.ipv6_rtr_addr, 0);
		$("ipv6_ipaddr_r").style.display="";
		if(v != ipv6_proto_orig){				
			$("ipv6_ipaddr_span").innerHTML = "";
		}else{
			$("ipv6_ipaddr_span").innerHTML = "";
		}

		$("ipv6_dns_setting").style.display="";
		inputCtrl(document.form.ipv6_dnsenable[0], 0);
		inputCtrl(document.form.ipv6_dnsenable[1], 0);
		inputCtrl(document.form.ipv6_dns1, 1);
		inputCtrl(document.form.ipv6_dns2, 1);
		inputCtrl(document.form.ipv6_dns3, 1);
	}
	else if(v == "6in4"){
		inputCtrl(document.form.ipv6_ifdev_select, 0);
		inputCtrl(document.form.ipv6_tun_v4end, 1);
		inputCtrl(document.form.ipv6_relay, 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[0], 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[1], 0);
		inputCtrl(document.form.ipv6_6rd_prefix, 0);
		inputCtrl(document.form.ipv6_6rd_prefixlen, 0);
		inputCtrl(document.form.ipv6_6rd_router, 0);
		inputCtrl(document.form.ipv6_6rd_ip4size, 0);
		inputCtrl(document.form.ipv6_tun_addr, 1);
		inputCtrl(document.form.ipv6_tun_addrlen, 1);
		inputCtrl(document.form.ipv6_tun_mtu, 1);
		inputCtrl(document.form.ipv6_tun_ttl, 1);
		$("ipv6_wan_setting").style.display="none";
		inputCtrl(document.form.ipv6_ipaddr, 0);
		inputCtrl(document.form.ipv6_prefix_len_wan, 0);
		inputCtrl(document.form.ipv6_gateway, 0);		
		$("ipv6_lan_setting").style.display="";
		inputCtrl(document.form.ipv6_prefix, 1);
		inputCtrl(document.form.ipv6_prefix_length, 1);
		$("ipv6_prefix_r").style.display="none";
		$("ipv6_prefix_length_r").style.display="none";
		inputCtrl(document.form.ipv6_rtr_addr, 0);
		$("ipv6_ipaddr_r").style.display="";
		if(v != ipv6_proto_orig){
				document.form.ipv6_prefix.value = "";
				document.form.ipv6_prefix_length.value = "";			
				$("ipv6_ipaddr_span").innerHTML = "";
		}else{
				$("ipv6_ipaddr_span").innerHTML = "";	
		}
		$("ipv6_dns_setting").style.display="";
		inputCtrl(document.form.ipv6_dnsenable[0], 0);
		inputCtrl(document.form.ipv6_dnsenable[1], 0);
		inputCtrl(document.form.ipv6_dns1, 1);
		inputCtrl(document.form.ipv6_dns2, 1);
		inputCtrl(document.form.ipv6_dns3, 1);
		
	}
	else if(v == "6rd"){
		inputCtrl(document.form.ipv6_ifdev_select, 0);
		inputCtrl(document.form.ipv6_tun_v4end, 0);
		inputCtrl(document.form.ipv6_relay, 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[0], 1);
		inputCtrl(document.form.ipv6_6rd_dhcp[1], 1);
		var enable = (document.form.ipv6_6rd_dhcp[1].checked) ? 1 : 0;
		inputCtrl(document.form.ipv6_6rd_prefix, enable);
		inputCtrl(document.form.ipv6_6rd_prefixlen, enable);
		inputCtrl(document.form.ipv6_6rd_router, enable);
		inputCtrl(document.form.ipv6_6rd_ip4size, enable);
		inputCtrl(document.form.ipv6_tun_addr, 0);
		inputCtrl(document.form.ipv6_tun_addrlen, 0);
		inputCtrl(document.form.ipv6_tun_mtu, 1);
		inputCtrl(document.form.ipv6_tun_ttl, 1);
		$("ipv6_wan_setting").style.display="none";
		inputCtrl(document.form.ipv6_ipaddr, 0);
		inputCtrl(document.form.ipv6_prefix_len_wan, 0);
		inputCtrl(document.form.ipv6_gateway, 0);		
		$("ipv6_lan_setting").style.display="";
		inputCtrl(document.form.ipv6_prefix, 0);
		inputCtrl(document.form.ipv6_prefix_length, 0);
		$("ipv6_prefix_r").style.display="";
		$("ipv6_prefix_length_r").style.display="";
		inputCtrl(document.form.ipv6_rtr_addr, 0);
		$("ipv6_ipaddr_r").style.display="";
		var enable = (document.form.ipv6_6rd_dhcp[1].checked) ? '0' : '1';
		showInputfield2('ipv6_6rd_dhcp', enable);
		$("ipv6_dns_setting").style.display="";
		inputCtrl(document.form.ipv6_dnsenable[0], 0);
		inputCtrl(document.form.ipv6_dnsenable[1], 0);
		inputCtrl(document.form.ipv6_dns1, 1);
		inputCtrl(document.form.ipv6_dns2, 1);
		inputCtrl(document.form.ipv6_dns3, 1);
		
	}
	else if(v == "other"){
		if(wan_proto_orig == "l2tp" || wan_proto_orig == "pptp" || wan_proto_orig == "pppoe")
			inputCtrl(document.form.ipv6_ifdev_select, 1);
		else	
			inputCtrl(document.form.ipv6_ifdev_select, 0);
		inputCtrl(document.form.ipv6_tun_v4end, 0);
		inputCtrl(document.form.ipv6_relay, 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[0], 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[1], 0);		
		inputCtrl(document.form.ipv6_6rd_prefix, 0);
		inputCtrl(document.form.ipv6_6rd_prefixlen, 0);
		inputCtrl(document.form.ipv6_6rd_router, 0);
		inputCtrl(document.form.ipv6_6rd_ip4size, 0);		
		inputCtrl(document.form.ipv6_tun_addr, 0);
		inputCtrl(document.form.ipv6_tun_addrlen, 0);
		inputCtrl(document.form.ipv6_tun_mtu, 0);
		inputCtrl(document.form.ipv6_tun_ttl, 0);		
		$("ipv6_wan_setting").style.display="";
		inputCtrl(document.form.ipv6_ipaddr, 1);
		inputCtrl(document.form.ipv6_prefix_len_wan, 1);
		inputCtrl(document.form.ipv6_gateway, 1);
		if(v != ipv6_proto_orig){
				document.form.ipv6_ipaddr.value="";
				document.form.ipv6_prefix_len_wan.value="";
				document.form.ipv6_gateway.value="";
		}
		$("ipv6_lan_setting").style.display="";
		$("ipv6_prefix_r").style.display="";
		$("ipv6_prefix_length_r").style.display="none";
		
		inputCtrl(document.form.ipv6_prefix, 0);
		inputCtrl(document.form.ipv6_prefix_length, 1);
		inputCtrl(document.form.ipv6_rtr_addr, 1);
		if(v != ipv6_proto_orig){
				$("ipv6_prefix_span").innerHTML = "";
				document.form.ipv6_prefix_length.value = "";
				document.form.ipv6_rtr_addr.value = "";
		}else{
				$("ipv6_prefix_span").innerHTML = "";
				document.form.ipv6_prefix_length.value = "64";
				document.form.ipv6_rtr_addr.value = "";
		}
		$("ipv6_ipaddr_r").style.display="none";
		$("ipv6_dns_setting").style.display="";
		inputCtrl(document.form.ipv6_dnsenable[0], 0);
		inputCtrl(document.form.ipv6_dnsenable[1], 0);
		inputCtrl(document.form.ipv6_dns1, 1);
		inputCtrl(document.form.ipv6_dns2, 1);
		inputCtrl(document.form.ipv6_dns3, 1);		
		
	}	
	else{		// disabled
		inputCtrl(document.form.ipv6_ifdev_select, 0);
		inputCtrl(document.form.ipv6_tun_v4end, 0);
		inputCtrl(document.form.ipv6_relay, 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[0], 0);
		inputCtrl(document.form.ipv6_6rd_dhcp[1], 0);
		inputCtrl(document.form.ipv6_6rd_prefix, 0);
		inputCtrl(document.form.ipv6_6rd_prefixlen, 0);
		inputCtrl(document.form.ipv6_6rd_router, 0);
		inputCtrl(document.form.ipv6_6rd_ip4size, 0);
		inputCtrl(document.form.ipv6_tun_addr, 0);
		inputCtrl(document.form.ipv6_tun_addrlen, 0);
		inputCtrl(document.form.ipv6_tun_mtu, 0);
		inputCtrl(document.form.ipv6_tun_ttl, 0);
		$("ipv6_wan_setting").style.display="none";
		inputCtrl(document.form.ipv6_ipaddr, 0);
		inputCtrl(document.form.ipv6_prefix_len_wan, 0);
		inputCtrl(document.form.ipv6_gateway, 0);		
		$("ipv6_lan_setting").style.display="none";
		inputCtrl(document.form.ipv6_prefix, 0);
		inputCtrl(document.form.ipv6_prefix_length, 0);
		$("ipv6_prefix_r").style.display="none";
		$("ipv6_prefix_length_r").style.display="none";
		inputCtrl(document.form.ipv6_rtr_addr, 0);
		$("ipv6_ipaddr_r").style.display="none";
		$("ipv6_dns_setting").style.display="none";
		inputCtrl(document.form.ipv6_dnsenable[0], 0);
		inputCtrl(document.form.ipv6_dnsenable[1], 0);
		inputCtrl(document.form.ipv6_dns1, 0);
		inputCtrl(document.form.ipv6_dns2, 0);
		inputCtrl(document.form.ipv6_dns3, 0);
		
	}		
	
	if(v != ipv6_proto_orig){
			update_info(0);
	}else{
			update_info(1);
	}
	
}

//Viz add 2011.11 for Input Control{
function showInputfield2(s, v){
	if(s=='ipv6_6rd_dhcp'){
		var enable = (v=='0') ? 1 : 0;
		inputCtrl(document.form.ipv6_6rd_prefix, enable);
		inputCtrl(document.form.ipv6_6rd_prefixlen, enable);
		inputCtrl(document.form.ipv6_6rd_router, enable);
		inputCtrl(document.form.ipv6_6rd_ip4size, enable);

		if(v != ipv6_tun6rd_dhcp || document.form.ipv6_service.value != ipv6_proto_orig){
//			var calc_hex = calcIP6(wan0_ipaddr);
//			document.form.ipv6_prefix.value = "2001:55c:"+calc_hex+"::";
//			document.form.ipv6_prefix_length.value = "64";
			$("ipv6_prefix_span").innerHTML = "";
			$("ipv6_prefix_length_span").innerHTML = "";
			$("ipv6_ipaddr_span").innerHTML = "";
		}else{
			$("ipv6_prefix_span").innerHTML = "";
			$("ipv6_prefix_length_span").innerHTML = "64";
			$("ipv6_ipaddr_span").innerHTML = "";
		}
	}

	if(s=='ipv6_dnsenable'){
		var enable = (v=='0') ? 1 : 0;
		inputCtrl(document.form.ipv6_dns1, enable);
		inputCtrl(document.form.ipv6_dns2, enable);
		inputCtrl(document.form.ipv6_dns3, enable);
	}
}
// } Viz add 2011.11 for Input Control


// test if WAN IP & Gateway & DNS IP is a valid IP
// DNS IP allows to input nothing
function valid_IP(obj_name, obj_flag){
		// A : 1.0.0.0~126.255.255.255
		// B : 127.0.0.0~127.255.255.255 (forbidden)
		// C : 128.0.0.0~255.255.255.254
		var A_class_start = inet_network("1.0.0.0");
		var A_class_end = inet_network("126.255.255.255");
		var B_class_start = inet_network("127.0.0.0");
		var B_class_end = inet_network("127.255.255.255");
		var C_class_start = inet_network("128.0.0.0");
		var C_class_end = inet_network("255.255.255.255");
		
		var ip_obj = obj_name;
		var ip_num = inet_network(ip_obj.value);

		if(obj_flag == "DNS" && ip_num == -1){ //DNS allows to input nothing
			return true;
		}
		
		if(obj_flag == "GW" && ip_num == -1){ //GW allows to input nothing
			return true;
		}
		
		if(ip_num > A_class_start && ip_num < A_class_end)
			return true;
		else if(ip_num > B_class_start && ip_num < B_class_end){
			alert(ip_obj.value+" is not a valid IP address!");
			ip_obj.value = "";
			ip_obj.focus();
			ip_obj.select();
			return false;
		}
		else if(ip_num > C_class_start && ip_num < C_class_end)
			return true;
		else{
			alert(ip_obj.value+" is not a valid IP address!");
			ip_obj.value = "";
			ip_obj.focus();
			ip_obj.select();
			return false;
		}
}

function ipv6_valid(obj){
	//var rangere=new RegExp("^[a-f0-9]{1,4}:([a-f0-9]{0,4}:){2,6}[a-f0-9]{1,4}$", "gi");	
	var rangere=new RegExp("^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b)\\.){3}(\\b((25[0-5])|(1\\d{2})|(2[0-4]\\d)|(\\d{1,2}))\\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$", "gi");
	if(rangere.test(obj.value)){
			//alert(obj.value+"good");	
			return true;
	}else{
			alert(obj.value+" is not a valid IP address!");
			obj.focus();
			obj.select();			
			return false;
	}	
}

function calcIP6(ip) {
	var octet = ip.split(".");
	base = 16;
	var octet1 = parseInt(octet[0]);
	var octet2 = parseInt(octet[1]);
	var octet3 = parseInt(octet[2]);
	var octet4 = parseInt(octet[3]);
	hextet21 = octet1.toString(base);
	hextet22 = octet2.toString(base);
	hextet31 = octet3.toString(base);
	hextet32 = octet4.toString(base);

	var hextetval21 = (octet1 < 16) ? "0" + hextet21 : hextet21;	
	var hextetval22 = (octet2 < 16) ? "0" + hextet22 : hextet22;
	var hextetval31 = (octet3 < 16) ? "0" + hextet31 : hextet31;
	var hextetval32 = (octet4 < 16) ? "0" + hextet32 : hextet32;

	var Calc_hex = hextetval21+hextetval22+":"+hextetval31+hextetval32;
	return Calc_hex;
}

function validForm(){
	
	if(document.form.ipv6_service.value=="static6" || document.form.ipv6_service.value=="other"){
		
				if(document.form.ipv6_service.value=="other"){
							if(!ipv6_valid(document.form.ipv6_ipaddr) || 
									!validate_range(document.form.ipv6_prefix_len_wan, 3, 64) ||
									!ipv6_valid(document.form.ipv6_gateway)){
										
										return false;
							}					
				}
		
				//!ipv6_valid(document.form.ipv6_prefix) || Viz rm 2013.05
				if(	!validate_range(document.form.ipv6_prefix_length, 3, 64) ||
						!ipv6_valid(document.form.ipv6_rtr_addr)){
						return false;
				}
				
				if(document.form.ipv6_dns1.value != ""){
						if(!ipv6_valid(document.form.ipv6_dns1)) return false;
				}
				if(document.form.ipv6_dns2.value != ""){
						if(!ipv6_valid(document.form.ipv6_dns2)) return false;
				}
				if(document.form.ipv6_dns3.value != ""){
						if(!ipv6_valid(document.form.ipv6_dns3)) return false;
				}											
	}
		
	if(document.form.ipv6_service.value=="dhcp6"){
				if(document.form.ipv6_dnsenable[1].checked){
								if(document.form.ipv6_dns1.value=="" && document.form.ipv6_dns2.value=="" && document.form.ipv6_dns3.value==""){
										alert("Fields cannot be blank.");
										document.form.ipv6_dns1.focus();
										document.form.ipv6_dns1.select();
										return false;			
								}
								if(document.form.ipv6_dns1.value != ""){
										if(!ipv6_valid(document.form.ipv6_dns1)) return false;
								}
								if(document.form.ipv6_dns2.value != ""){
										if(!ipv6_valid(document.form.ipv6_dns2)) return false;
								}
								if(document.form.ipv6_dns3.value != ""){
										if(!ipv6_valid(document.form.ipv6_dns3)) return false;
								}						
				}
	}
	
	if(document.form.ipv6_service.value=="6to4" ||document.form.ipv6_service.value=="6in4" ||document.form.ipv6_service.value=="6rd" ){
			if(!validate_range_sp(document.form.ipv6_tun_mtu,1280,1480,0))  return false;  //MTU
			if(!validate_range_sp(document.form.ipv6_tun_ttl,0,255,255))  return false;  //TTL				

			if(document.form.ipv6_dns1.value != ""){
					if(!ipv6_valid(document.form.ipv6_dns1)) return false;
			}
			if(document.form.ipv6_dns2.value != ""){
					if(!ipv6_valid(document.form.ipv6_dns2)) return false;
			}
			if(document.form.ipv6_dns3.value != ""){
					if(!ipv6_valid(document.form.ipv6_dns3)) return false;
			}
	}	
	
	if(document.form.ipv6_service.value=="6to4"){
			if(!valid_IP(document.form.ipv6_relay, "")) return false;  //6to4 tun relay	
	}
	
	if(document.form.ipv6_service.value=="6in4"){
			if(!validate_iprange(document.form.ipv6_tun_v4end, "")) return false;  //6in4 tun endpoint	
			if(!ipv6_valid(document.form.ipv6_tun_addr)) return false;  //6in4 Client IPv6 Address			
			if(!validate_range(document.form.ipv6_tun_addrlen, 3, 64))  return false;
	}	
	
	if(document.form.ipv6_service.value=="6rd" && document.form.ipv6_6rd_dhcp[1].checked){
			if(!ipv6_valid(document.form.ipv6_6rd_prefix) ||
					!validate_range(document.form.ipv6_6rd_prefixlen, 3, 64)){
					return false;
			}
			if(!validate_iprange(document.form.ipv6_6rd_router, "")) return false;  //6rd ip4 router
			if(!validate_range(document.form.ipv6_6rd_ip4size, 0, 32)) return false;  //6rd ip4 router mask length
	}
	
	return true;
}


function applyRule(){
	if(validForm()){

		if(document.form.ipv6_service.value=="dhcp6")		//ipv6_dhcppd.value=1 when "dhcp6"
				document.form.ipv6_dhcppd.value=1;
		else
				document.form.ipv6_dhcppd.value=0;
				
		if(document.form.ipv6_ifdev_select.disabled){		// set ipv6_ifdev="eth" while interface is disabled.
				document.form.ipv6_ifdev.value = "eth";
		}else{
				document.form.ipv6_ifdev.value = document.form.ipv6_ifdev_select.value;
		}			
				
		if(document.form.ipv6_service.value!="static6" && document.form.ipv6_service.value!="other")	//clean up ipv6_rtr_addr if not static6 or not other
				document.form.ipv6_rtr_addr.value = "";

		/*if(machine_arm)	//Viz 2013.06 Don't need to reboot anymore
		{ // MODELDEP: Machine ARM structure
			if((document.form.ipv6_service.value == "disabled" && document.form.ipv6_service_orig.value != "disabled") ||
				 (document.form.ipv6_service.value != "disabled" && document.form.ipv6_service_orig.value == "disabled"))
    		FormActions("start_apply.htm", "apply", "reboot", "70");
		}*/
	
		document.form.ipv6_accept_ra.value=1;			// 0/1/2 default:1	
		showLoading(3);		
		//document.form.submit();
	}
}

/*------------ get IPv6 info Start -----------------*/
function update_info(flag){
	if(flag == 0)
			return false;
			
		$j.ajax({
				url: '/update_IPv6state.html',
				dataType: 'script',
				timeout: 1500,
				error: function(xhr){
						setTimeout("update_info();", 1500);
				},
				success: function(response){
						showInfo();
				}
		});
	
}	

function showInfo(){
		if(document.form.ipv6_service.value == ipv6_proto_orig){
			if($("ipv6_prefix_r").style.display == ""){
					$("ipv6_prefix_span").innerHTML = state_ipv6_prefix;
			}
			if($("ipv6_prefix_length_r").style.display == ""){
					$("ipv6_prefix_length_span").innerHTML = state_ipv6_prefix_length;
			}
			if($("ipv6_ipaddr_r").style.display == ""){
					$("ipv6_ipaddr_span").innerHTML = state_ipv6_rtr_addr;
			}
			setTimeout("update_info();", 1500);
		}		
}
/*------------- get IPv6 info end ----------------------------*/

</script>
</head>

<body onload="initial();" onunLoad="return unload_body();">
<div id="TopBanner"></div>
<div id="hiddenMask" class="popup_bg">
	<table cellpadding="5" cellspacing="0" id="dr_sweet_advise" class="dr_sweet_advise" align="center">
		<tr>
		<td>
			<div class="drword" id="drword" style="height:110px;">Please wait,  Proceeding...
				<br/>
				<br/>
	    </div>
		  <div class="drImg"><img src="images/alertImg.png"></div>
			<div style="height:70px;"></div>
		</td>
		</tr>
	</table>
<!--[if lte IE 6.5]><iframe class="hackiframe"></iframe><![endif]-->
</div>
<div id="Loading" class="popup_bg"></div>
<iframe name="hidden_frame" id="hidden_frame" src="Advanced_IPv6_Content.html" width="0" height="0" frameborder="0"></iframe>
<form method="post" name="form" id="ruleForm" action="http://event.asus.com/start_apply.htm" target="hidden_frame">
<input type="hidden" name="productid" value="RT-AC66U">
<input type="hidden" name="current_page" value="Advanced_IPv6_Content.html">
<input type="hidden" name="next_page" value="Advanced_IPv6_Content.html">
<input type="hidden" name="next_host" value="">
<input type="hidden" name="group_id" value="">
<input type="hidden" name="modified" value="0">
<input type="hidden" name="action_mode" value="apply">
<input type="hidden" name="action_script" value="restart_allnet">
<input type="hidden" name="action_wait" value="30">
<input type="hidden" name="preferred_lang" id="preferred_lang" value="EN">
<input type="hidden" name="firmver" value="3.0.0.4">
<input type="hidden" name="wan_unit" value="0">
<input type="hidden" name="ipv6_dhcppd" value="1">
<input type="hidden" name="ipv6_accept_ra" value="1">
<input type="hidden" name="ipv6_ifdev" value="">
<input type="hidden" name="ipv6_service_orig" value="disabled" disabled>
<table class="content" align="center" cellpadding="0" cellspacing="0">
  <tr>
	<td width="17">&nbsp;</td>
	
	<!--=====Beginning of Main Menu=====-->
	<td valign="top" width="202">
	  <div id="mainMenu"></div>
	  <div id="subMenu"></div>
	</td>
	
	<td valign="top">
	<div id="tabMenu" class="submenuBlock"></div>
		<!--===================================Beginning of Main Content===========================================-->
	<table width="98%" border="0" align="left" cellpadding="0" cellspacing="0">
	<tr>
		<td align="left" valign="top">
	  <table width="760px" border="0" cellpadding="5" cellspacing="0" class="FormTitle" id="FormTitle">
		<tbody>
		<tr>
			<td bgcolor="#4D595D" valign="top">
				<div>&nbsp;</div>
				<div class="formfonttitle">IPv6</div>
	      <div style="margin-left:5px;margin-top:10px;margin-bottom:10px"><img src="images/New_ui/export/line_export.png"></div>
	      <div class="formfontdesc">Configure the IPv6 Internet setting of RT-AC66U.</div>
				<div class="formfontdesc" style="margin-top:-10px;">
					<a id="faq" href="Advanced_IPv6_Content.html" target="_blank" style="font-family:Lucida Console;text-decoration:underline;">IPv6 FAQ</a>
				</div>
				  
			<!---------------------------------------basic_config start------------------------------------>  
			<table id="basic_config" width="100%" border="1" align="center" cellpadding="4" cellspacing="0" bordercolor="#6b8fa3"  class="FormTable">
				  <thead>
				  <tr>
						<td colspan="2">Basic Config</td>
				  </tr>
				  </thead>		

					<tr>
						<th>Connection type</th>
		     		<td>
							<select name="ipv6_service" class="input_option" onchange="showInputfield(this.value);">
								<option class="content_input_fd" value="disabled" selected>Disable</option>
								<!--option class="content_input_fd" value="static6" >Native IPv6</option-->
								<option class="content_input_fd" value="dhcp6" >Native with DHCP-PD</option>
								<option class="content_input_fd" value="6to4" >Tunnel 6to4</option>
								<option class="content_input_fd" value="6in4" >Tunnel 6in4</option>
								<option class="content_input_fd" value="6rd" >Tunnel 6rd</option>
								<option class="content_input_fd" value="other" >Static IPv6</option>
								<!--option class="content_input_fd" value="slaac" >SLAAC</option-->
								<!--option class="content_input_fd" value="icmp6" >ICMPv6</option-->
							</select>
		     		</td>
		     	</tr>

					<tr>
						<th>Interface</th>
		     		<td>
							<select name="ipv6_ifdev_select" class="input_option">
								<option class="content_input_fd" value="ppp" >PPP</option>
								<option class="content_input_fd" value="eth" selected>Ethernet</option>
							</select>
		     		</td>
		     	</tr>

					<tr style="display:none;">
						<th>Server IPv4 Address</th>
		     		<td>
							<input type="text" maxlength="15" class="input_15_table" name="ipv6_tun_v4end" value="0.0.0.0">
		     		</td>
		     	</tr>

					<tr style="display:none;">
						<th>IPv4 Anycast Relay</th>
		     		<td>
							<input type="text" maxlength="15" class="input_15_table" name="ipv6_relay" value="192.88.99.1">
		     		</td>
		     	</tr>

					<tr style="display:none;">
						<th>DHCP Option</th>
		     		<td>
								<input type="radio" name="ipv6_6rd_dhcp" class="input" value="1" onclick="showInputfield2('ipv6_6rd_dhcp', this.value);" checked>Enable
								<input type="radio" name="ipv6_6rd_dhcp" class="input" value="0" onclick="showInputfield2('ipv6_6rd_dhcp', this.value);" >Disable
		     		</td>
		     	</tr>
					<tr style="display:none;">
						<th>IPv6 Prefix</th>
		     		<td>
							<input type="text" maxlength="39" class="input_32_table" name="ipv6_6rd_prefix" value="">
		     		</td>
		     	</tr>		     	
					<tr style="display:none;">
						<th>IPv6 Prefix Length</th>
		     		<td>
							<input type="text" maxlength="2" class="input_3_table" name="ipv6_6rd_prefixlen" value="32">
		     		</td>
		     	</tr>
					<tr style="display:none;">
						<th>IPv4 Border Router</th>
		     		<td>
							<input type="text" maxlength="15" class="input_15_table" name="ipv6_6rd_router" value="0.0.0.0">
		     		</td>
		     	</tr>
					<tr style="display:none;">
						<th>IPv4 Router Mask Length</th>
		     		<td>
							<input type="text" maxlength="2" class="input_3_table" name="ipv6_6rd_ip4size" value="0">
		     		</td>
		     	</tr>
		     	
					<tr style="display:none;">
						<th>Client IPv6 Address</th>
		     		<td>
							<input type="text" maxlength="39" class="input_32_table" name="ipv6_tun_addr" value="">
		     		</td>
		     	</tr>		     	
					<tr style="display:none;">
						<th>IPv6 Prefix Length</th>
		     		<td>
							<input type="text" maxlength="2" class="input_3_table" name="ipv6_tun_addrlen" value="64">
		     		</td>
		     	</tr>
		     	
					<tr style="display:none;">
						<th>Tunnel MTU</th>
		     		<td>
							<input type="text" maxlength="4" class="input_6_table" name="ipv6_tun_mtu" value="0">
		     		</td>
		     	</tr>
					<tr style="display:none;">
						<th>Tunnel TTL</th>
		     		<td>
							<input type="text" maxlength="3" class="input_6_table" name="ipv6_tun_ttl" value="255">
		     		</td>
		     	</tr>		     			     	
			</table>	
			<!---------------------------------------basic_config end------------------------------------>  
			
			<!---------------------------------------IPv6 WAN setting start------------------------------->  
			<table id="ipv6_wan_setting" style="margin-top:8px;" width="100%" border="1" align="center" cellpadding="4" cellspacing="0" bordercolor="#6b8fa3"  class="FormTable">
				  <thead>
				  <tr>
						<td colspan="2">IPv6 WAN Setting</td>
				  </tr>
				  </thead>
					<tr>
						<th>WAN IPv6 Address</th>
		     		<td>
						  	<input type="text" maxlength="39" class="input_32_table" name="ipv6_ipaddr" value="">
						</td>
					</tr>
					<tr>
						<th>WAN Prefix Length</th>
						<td>
								<input type="text" maxlength="2" class="input_3_table" name="ipv6_prefix_len_wan" value="64">
		     		</td>
		     	</tr>
					<tr>
						<th>WAN IPv6 Gateway</th>
		     		<td>
						  	<input type="text" maxlength="39" class="input_32_table" name="ipv6_gateway" value="">
						</td>
					</tr>										
			</table>
			<!---------------------------------------IPv6 WAN setting  end ------------------------------->  
			
			<!---------------------------------------IPv6 LAN setting start------------------------------->  
			<table id="ipv6_lan_setting" style="margin-top:8px;" width="100%" border="1" align="center" cellpadding="4" cellspacing="0" bordercolor="#6b8fa3"  class="FormTable">
				  <thead>
				  <tr>
						<td colspan="2">IPv6 LAN Setting</td>
				  </tr>
				  </thead>		
					<tr>
						<th>LAN IPv6 Prefix</th>
		     		<td>
						  	<input type="text" maxlength="39" class="input_32_table" name="ipv6_prefix" value="">
						</td>
					</tr>
					<tr id="ipv6_prefix_r">
						<th>LAN IPv6 Prefix</th>
		     		<td>
						  <div id="ipv6_prefix_span" name="ipv6_prefix_span" style="color:#FFFFFF;margin-left:8px;"></div>
						</td>
					</tr>
					<tr>
						<th>LAN Prefix Length</th>
						<td>
								<input type="text" maxlength="2" class="input_3_table" name="ipv6_prefix_length" value="64">
		     		</td>
		     	</tr>
					<tr id="ipv6_prefix_length_r">
						<th>LAN Prefix Length</th>
						<td>
						  <div id="ipv6_prefix_length_span" name="ipv6_prefix_length_span" style="color:#FFFFFF;margin-left:8px;"></div>
		     		</td>
		     	</tr>		     	
					<tr style="display:none;">
						<th>LAN IPv6 Address</th>	<!-- for Native w/o DHCP-->
		     		<td>
						  <input type="text" maxlength="39" class="input_32_table" name="ipv6_rtr_addr" value="">
		     		</td>
		     	</tr>
					<tr id="ipv6_ipaddr_r">
						<th>LAN IPv6 Address</th>	<!-- for other ipv6 proto -->
		     		<td>
						  <div id="ipv6_ipaddr_span" name="ipv6_ipaddr_span" style="color:#FFFFFF;margin-left:8px;"></div>
		     		</td>
		     	</tr>
			</table>
			<!---------------------------------------IPv6 LAN setting end------------------------------->  	
			
			<!---------------------------------------IPv6 DNS setting start------------------------------->  	
			<table id="ipv6_dns_setting" style="margin-top:8px;" width="100%" border="1" align="center" cellpadding="4" cellspacing="0" bordercolor="#6b8fa3"  class="FormTable">
				  <thead>
				  <tr>
						<td colspan="2">IPv6 DNS Setting</td>
				  </tr>
				  </thead>		
					<tr style="display:none;">
						<th>Connect to DNS Server automatically</th>
		     		<td>
								<input type="radio" name="ipv6_dnsenable" class="input" value="1" onclick="showInputfield2('ipv6_dnsenable', this.value);" checked>Enable
								<input type="radio" name="ipv6_dnsenable" class="input" value="0" onclick="showInputfield2('ipv6_dnsenable', this.value);" >Disable
		     		</td>
		     	</tr>
					<tr style="display:none;">
						<th>IPv6 DNS Server 1</th>
		     		<td>
						  <input type="text" maxlength="39" class="input_32_table" name="ipv6_dns1" value="">
		     		</td>
		     	</tr>
					<tr style="display:none;">
						<th>IPv6 DNS Server 2</th>
		     		<td>
						  <input type="text" maxlength="39" class="input_32_table" name="ipv6_dns2" value="">
		     		</td>
		     	</tr>
					<tr style="display:none;">
						<th>IPv6 DNS Server 3</th>
		     		<td>
						  <input type="text" maxlength="39" class="input_32_table" name="ipv6_dns3" value="">
		     		</td>
		     	</tr>		     	
			</table>
			<!---------------------------------------IPv6 DNS setting end------------------------------->  
			
			<!---------------------------------------Auto Config start------------------------------->  
			<table id="auto_config" style="margin-top:8px;" width="100%" border="1" align="center" cellpadding="4" cellspacing="0" bordercolor="#6b8fa3"  class="FormTable">
				  <thead>
				  <tr>
						<td colspan="2">Auto Configuration Setting</td>
				  </tr>
				  </thead>		
					<tr>
						<th>Enable Router Advertisement</th>
		     		<td>
							<select name="ipv6_radvd" class="input_option">
								<option class="content_input_fd" value="1" selected>Enable</option>
								<option class="content_input_fd" value="0" >Disable</option>
							</select>
		     		</td>
		     	</tr>
					<!--tr>
						<th>Receive Advertisement ?</th>
		     		<td>
							<select name="ipv6_accept_ra" class="input_option">
								<option class="content_input_fd" value="0" >Disable</option>
								<option class="content_input_fd" value="1" selected>From WAN</option>
								<option class="content_input_fd" value="2" >From LAN</option>
							</select>
		     		</td>
		     	</tr-->
			</table>
			<!---------------------------------------Auto Config end ------------------------------->  	
				
				<div class="apply_gen">
					<input class="button_gen" onclick="applyRule()" type="button" value="Apply"/>
				</div>
			</td>
		</tr>
		</tbody>	
	  </table>
		</td>
	</tr>
	</table>				
			<!--===================================End of Main Content===========================================-->
	</td>
  <td width="10" align="center" valign="top">&nbsp;</td>
	</tr>
</table>
</form>					

<div id="footer"></div>
</body>
</html>
